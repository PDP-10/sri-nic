00010  REM A$(20),B$(20),C$(20),M$(20),N$(20),O$(20),A0$(1)(20)
00020  REM Q$(20),R$(20),S$(20),V$(20),X$(72),Y$(72),Z$(72)
00030  DIM A(50),B(50),C(50),D(50),E(50),F(50),G(10),H(10),I(50),J(50)
00040  DIM K(50),L(50),M(10,6),N(10,4),O(10),P(10),Q(10,4),R(10,4)
00050  DIM S(10,8),T(10,9),U(10,6),V(10,6),W(10),X(50),Y(50),Z(10,10)
00060  DIM A0$(10),A1$(5),A2$(29),A3$(4),A0(10),A1(10),A2(10)
00070  REM A,D1,D2,I,I1,I2,K1,K2,K3,K4,N,N1,N2,O,O1,O2,P1,P2,P3,P4
00080  REM: TREK73
00090  RANDOMIZE
00100  DEF FNA(X)=X*1.74533E-02
00110  DEF FNB(X)=X*57.2958
00120  DEF FNC(X)=X-INT(X*2.77778E-03)*360
00130  DEF FNR(X)=INT(X*RND)+1
00140  DEF FNS(X)=SQR((X(I)-X(J))^2+(Y(I)-Y(J))^2)
00150  PRINT 
00160  PRINT "Captain:  Your last name is";
00170  INPUT N$
00180  IF LEN(N$)=0 THEN 160
00190  L=0
00200  IF LEFT$(N$,1) <> "*" THEN 230
00210  N$=RIGHT$(N$,2)
00220  L=1
00230  P(1)=0
00240  PRINT N$;":  Your gender is";
00250  INPUT X$
00260  O$="sir"
00270  IF LEFT$(X$,1)="M" THEN 360
00280  O$="miss"
00290  IF LEFT$(X$,1)="F" THEN 360
00300  ON FNR(3) GOTO 310,330,350
00310  O$="Dolly"
00320  GOTO 360
00330  O$="Christine"
00340  GOTO 360
00350  O$="Janice Rand"
00360  PRINT "   I'm expecting (1-9)    enemy vessels.";
00370   FOR A=1 TO 18
00380   PRINT CHR$(8);
00390   NEXT A
00400  INPUT A
00410  IF A<>INT(A) THEN 440
00420  IF A<=0 THEN 440
00430  IF A<10 THEN 490
00440  PRINT "Uhura:  ";O$;", Starfleet Command reports that it can only"
00450  PRINT "   be from 1 to 9.  Try again."
00460  PRINT N$;":  Correct, Lieutenant--just testing your attention."
00470  GOTO 360
00480  REM  (ENEMY VESSELS)
00490  N=A+1
00500  MAT I=ZER
00510   FOR I=1 TO 10
00520   I(I)=I
00530   NEXT I
00540  REM  (SCRAMBLE NAMES)
00550   FOR I=2 TO 9
00560   K=FNR(11-I)+I-1
00570   X=I(I)
00580   I(I)=I(K)
00590   I(K)=X
00600   NEXT I
00610   FOR I=N+1 TO 10
00620   I(I)=0
00630   NEXT I
00640  REM  (SELECT FEDERATION VESSELS)
00650  GOSUB 22030
00660  DATA "","Enterprise","Exeter","Excalibur","Lexington","Hood"
00670  DATA "Yorktown","Potemkin","Republic","Constitution","Kongo"
00680  DATA "Constellation","Faragaut","Valiant","Intrepid"
00690   FOR I=1 TO FNR(14)
00700   READ A0$(1)
00710   NEXT I
00720  REM  (SELECT ENEMY NATIONS)
00730  GOSUB 22030
00740  DATA "","Centurian","Klingon","Orion","Romulan","Tholian"
00750   FOR I=1 TO FNR(5)
00760   READ R$
00770   NEXT I
00780  REM  (SELECT ENEMY CAPTAINS)
00790  GOSUB 22030
00800  DATA "","BOLAK","KANG","KOLOTH","KOR","KORAX","KRULIX","LOSKENE"
00810  DATA "TAL","TROBLAK"
00820   FOR I=1 TO FNR(9)
00830   READ S$
00840   NEXT I
00850  IF L=1 THEN 2190
00860  PRINT 
00870  PRINT "SPACE, THE FINAL FRONTIER."
00880  PRINT "THESE ARE THE VOYAGES OF THE STARSHIP ";A0$(1);"."
00890  PRINT "ITS FIVE YEAR MISSION:  TO EXPLORE STRANGE NEW WORLDS,"
00900  PRINT "TO SEEK OUT NEW LIFE AND NEW CIVILIZATIONS,"
00910  PRINT "TO BOLDLY GO WHERE NO MAN HAS GONE BEFORE!"
00920  PRINT 
00930  PRINT TAB(20);"S T A R   T R E K"
00940  PRINT 
00950  PRINT "CAPTAIN ";N$;":  CAPTAIN'S LOG, STARDATE";RND*100000
00960  REM  (SELECT MISSIONS)
00970  GOSUB 22030
00980  DATA ""
00990  DATA " THE ENTERPRISE IS ON COURSE FOR EPSILON CANARES III TO TREAT"
01000  DATA "COMMISSIONER HEDFORD FOR SAKURO'S DISEASE."
01010  DATA " WE HAVE BEEN ASSIGNED TO TRANSPORT FEDERATION AMBASSIDORS"
01020  DATA " TO THE PLANETARY CONFERENCE ON THE NEUTRAL ASTEROID"
01030  DATA "CODE NAMED:  'BABEL.'"
01040  DATA " THE ENTERPRISE HAS BEEN ORDERED TO ESTABLISH CONTACT"
01050  DATA "WITH THE MELKOTIANS AT ALL COSTS."
01060  DATA " THE ENTERPRISE IS RESPONDING TO A PRIORITY ONE DISTRESS"
01070  DATA " CALL FROM DEEP SPACE STATION K-7.  MORE THAN AN EMERGENCY,"
01080  DATA "IT SIGNALS NEAR OR TOTAL DISASTER!"
01090  DATA " THE ENTERPRISE IS APPROACHING THE LAST REPORTED"
01100  DATA " POSITION OF THE STARSHIP DEFIANT WHICH VANISHED WITHOUT"
01110  DATA "TRACE THREE WEEKS AGO."
01120  DATA " THE ENTERPRISE IS EN ROUTE TO 'MEMORY ALPHA', A"
01130  DATA " PLANETOID SET UP BY THE FEDERATION AS A CENTRAL LIBRARY"
01140  DATA " CONTAINING THE TOTAL CULTURAL HISTORY AND SCIENTIFIC"
01150  DATA "KNOWLEDGE OF ALL PLANETARY FEDERATION MEMBERS."
01160  DATA " THE PLANET ARIANNUS IS VITAL AS A TRANSFER POINT ON"
01170  DATA " REGULAR SPACE COMMERCIAL LANES.  IT HAS BEEN ATTACKED BY"
01180  DATA " A BACTERIAL INVASION WHICH THREATENS TO RENDER IT"
01190  DATA "LIFELESS UNLESS CHECKED.  OUR MISSION:  TO DECONTAMINATE IT."
01200  DATA " THE ENTERPRISE HAS BEEN ORDERED TO INVESTIGATE A FIND OF"
01210  DATA "TRITANIUM ON BETA VII."
01220  DATA "WE ARE PROCEEDING TO ARGELIUS FOR THERAPEUTIC SHORE LEAVE."
01230  DATA " THE ENTERPRISE IS PROCEEDING TO SIGMA IOITA III TO STUDY"
01240  DATA " THE EFFECTS OF CULTURAL CONTAMINATION ON A DEVELOPING"
01250  DATA "SOCIETY."
01260  DATA " WE HAVE ALTERED COURSE FOR A RESCUE MISSION IN THE GAMMA"
01270  DATA " 7A SYSTEM, THE LAST REPORTED POSITION OF THE STARSHIP"
01280  DATA "INTREPID."
01290  DATA " WE ARE ON A ROUTINE CARTEGRAPHIC MISSION TO POLUX IX."
01300  DATA " THE ENTERPRISE IS RESPONDING TO A DISTRESS CALL FROM"
01310  DATA "A FEDERATION SCIENCE TEAM IN THE MALURIAN STAR SYSTEM."
01320  DATA " WE ARE TO NEGOTIATE A TREATY TO MINE DILITHIUM CRYSTALS"
01330  DATA "FROM THE HALKINS."
01340  DATA " WE ARE HEADED FOR PLANETS L370 AND L374 TO INVESTIGATE THE"
01350  DATA "DISAPPEARANCE OF THE STARSHIP CONSTELLATION IN THAT VICINITY."
01360  DATA " THE ENTERPRISE HAS BEEN ORDERED TO REPORT TO SPACE STATION"
01370  DATA "K-2 TO TEST DR. RICHARD DAYSTROM'S COMPUTER, M-5."
01380  DATA " WE HAVE ENCOUNTERED DEBRIS FROM THE SS BEAGEL AND ARE"
01390  DATA "PROCEEDING TO PLANET 4, SYSTEM 892 TO INVESTIGATE."
01400  DATA " THE ENTERPRISE IS PROCEEDING TO THE PLANET EKOS TO LOCATE"
01410  DATA "FEDERATION CULTURAL OBSERVER PROF. JOHN GILL."
01420  DATA " WE ARE TO DIVERT AN ASTEROID FROM DESTROYING AN INHABITED"
01430  DATA "PLANET."
01440  DATA " WE HAVE BEEN ASSIGNED TO TRANSPORT THE MEDUSIAN "
01450  DATA "AMBASSADOR TO THE FEDERATION BACK TO HIS HOME PLANET."
01460  DATA " THE ENTERPRISE HAS BEEN ORDERED TO EVACUATE THE SCIENTIFIC "
01470  DATA " PERSONNEL FROM THE RESEARCH STATION ON A PLANET IN THE "
01480  DATA "MINARA STAR SYSTEM BEFORE THAT STAR GOES NOVA."
01490  DATA " THE ENTERPRISE IS RESPONDING TO A DISTRESS CALL FROM "
01500  DATA "THE PLANET SCALOS."
01510  DATA " ON A TOP SECRET DIPLOMATIC MISSION, THE ENTERPRISE HAS "
01520  DATA "ENTERED THE TELLUN STAR SYSTEM."
01530  DATA " WE ARE PREPARING TO ENTER ORBIT AROUND THE PLANET GIDEON "
01540  DATA " WHICH IS STILL NOT A MEMBER OF THE UNITED FEDERATION "
01550  DATA "OF PLANETS."
01560  DATA " THE ENTERPRISE IS APPROACHING ELBA II; A PLANET WITH A"
01570  DATA " POISONOUS ATMOSPHERE, WHERE THE FEDERATION  MAINTAINS AN"
01580  DATA " ASYLUM FOR THE FEW REMAINING INCOURAGABLE CRIMINALLY"
01590  DATA " INSANE OF THE GALAXY. WE ARE BRINGING A REVOLUTIONARY "
01600  DATA " NEW MEDICINE WITH WHICH THE FEDERATION HOPES TO ELIMINATE "
01610  DATA "MENTAL ILLNESS FOR ALL TIME."
01620  DATA " WE HAVE CALCULATED THAT BETA NIOBE WILL GO NOVA IN"
01630  DATA " APPROXIMATELY THREE AND ONE HALF HOURS.  ITS ONLY"
01640  DATA " SATELLITE, SARPEIDON, IS A CLASS 'M' PLANET WHICH AT"
01650  DATA " LAST REPORT WAS INHABITED BY A CIVILIZED HUMANOID"
01660  DATA " SPECIES.  NOW OUR INSTRUMENTS SHOW THAT NO INTELLIGENT"
01670  DATA "LIFE REMAINS ON THE PLANET."
01680  DATA " THE ENTERPRISE HAS RECEIVED A DISTRESS CALL FROM A"
01690  DATA " GROUP OF SCIENTISTS ON CAMUS II WHO WERE EXPLORING"
01700  DATA "THE RUINS OF A DEAD CIVILIZATION."
01710  DATA " THE ENTERPRISE IS APPROACHING PLANET EXO III TO SEARCH"
01720  DATA "FOR BIOLOGIST DR. ROGER KORBY."
01730  DATA " IN THE DISTANT REACHES OF OUR GALAXY WE HAVE MADE AN"
01740  DATA " ASTONISHING DISCOVERY;  EARTH-STYLE RADIO SIGNALS"
01750  DATA " COMING FROM A PLANET WHICH APPARANTLY IS AN EXACT"
01760  DATA "DUPLICATE OF THE EARTH."
01770  DATA " THE ENTERPRISE HAS BEEN DIVERTED FROM ITS SCHEDULED"
01780  DATA " COURSE TO CONFIRM DISCOVERY  BY DR. THOMAS LEIGHTON OF"
01790  DATA " AN EXTRAORDINARY NEW SYNTHETIC FOOD WHICH WOULD TOTALLY"
01800  DATA " END THE THREAT OF FAMINE ON CYGNIA MINOR, A NEARBY"
01810  DATA "EARTH COLONY."
01820  DATA " THE ENTERPRISE IS EN ROUTE TO PLANET BETA III TO TRY TO"
01830  DATA " FIND SOME TRACE OF THE STARSHIP ARCHON WHICH DISAPPEARED"
01840  DATA "NEAR THERE SOME 100 YEARS AGO."
01850  DATA " THE ENTERPRISE IS EN ROUTE TO STAR CLUSTER NGC 321,"
01860  DATA " PLANET EMINIAR VII, THE PRINCIPLE PLANET OF THE STAR"
01870  DATA "CLUSTER.  OUR MISSION IS TO ESTABLISH DIPLOMATIC RELATIONS."
01880  DATA " WE HAVE ALTERED COURSE FOR A RESCUE MISSION IN THE GAMMA 7A"
01890  DATA "SYSTEM."
01900  DATA " WE ARE PRESENTLY ON COURSE FOR ALTAIR 6 TO ATTEND INAUGURATION"
01910  DATA "CEREMONIES ON THAT PLANET."
01920  DATA " WE ARE TO INVESTIGATE STRANGE SENSOR READINGS REPORTED BY A"
01930  DATA "SCOUTSHIP INVESTIGATING GAMMA TRIANGULA 6."
01940   FOR I=1 TO FNR(33)
01950   READ X$
01960   IF LEFT$(X$,1)=" " THEN 1950
01970   NEXT I
01980  READ X$
01990  IF LEFT$(X$,1)<>" " THEN 2020
02000  PRINT "  ";X$
02010  GOTO 1980
02020  PRINT "   ";X$
02030  X$="123456789"
02040  X$=MID$(X$,A,1)
02050  Y$=""
02060  IF A=1 THEN 2080
02070  Y$="S"
02080  PRINT "SULU:  ";O$;", I'M PICKING UP ";X$;" VESSEL";Y$;" ON INTERCEPTION"
02090  PRINT "   COURSE";Y$;" WITH THE ";A0$(1);"."
02100  X$="IT"
02110  Z$="A "
02120  IF A=1 THEN 2150
02130  X$="THEM"
02140  Z$=""
02150  PRINT "SPOCK:  SENSORS IDENTIFY ";X$;" AS ";Z$;R$;" BATTLE"
02160  PRINT "   CRUISER";Y$;", PROBABLY CAPTAINED BY ";S$;"."
02170  PRINT N$;":  RED ALERT, LIEUTENANT!"
02180  PRINT "UHURA:  AYE, ";O$;"!  RED ALERT!  ALL DECKS GO TO RED ALERT!"
02190  PRINT 
02200  PRINT "COMPUTER:  THE ";R$;"S ARE ATTACKING THE ";A0$(1);" WITH THE"
02210  GOSUB 22070
02220  PRINT "  ";
02230   FOR I=2 TO N
02240   PRINT " ";A0$(I(I));
02250   IF I=N THEN 2300
02260   IF A<3 THEN 2290
02270   PRINT ",";
02280   IF I+1<N THEN 2300
02290   PRINT " AND THE";
02300   NEXT I
02310  PRINT "."
02320  REM          ----- MAJOR INITIALIZATIONS -----
02330  D1=.2
02340  I1=N
02350  I2=50
02360  K1=4
02370  K2=6
02380  O1=O2=P1=P2=P3=P4=0
02390  MAT A=ZER
02400  MAT B=ZER
02410  MAT C=ZER
02420  MAT D=ZER
02430  MAT E=ZER
02440  MAT F=ZER
02450  MAT G=ZER
02460  MAT H=ZER
02470  MAT J=ZER
02480  MAT K=ZER
02490  MAT L=ZER
02500  MAT M=ZER
02510  MAT N=ZER
02520  MAT O=ZER
02530  MAT P=ZER
02540  MAT Q=ZER
02550  MAT R=ZER
02560  MAT S=ZER
02570  MAT T=ZER
02580  MAT U=ZER
02590  MAT V=ZER
02600  MAT W=ZER
02610  MAT X=ZER
02620  MAT Y=ZER
02630  MAT Z=ZER
02640   FOR I=1 TO I1
02650   A(I)=B(I)=1
02660   C(I)=D(I)=FNR(360)
02670   E(I)=.75
02680   F(I)=200
02690   H(I)=200
02700   G(I)=10
02710   J(I)=1
02720    FOR K=1 TO K1
02730    Q(I,K)=10
02740    R(I,K)=10
02750    NEXT K
02760   M(I,5)=10
02770   M(I,6)=100
02780   N(I,1)=90
02790   N(I,4)=270
02800   T(I,7)=12
02810   T(I,8)=10
02820   T(I,9)=200
02830   U(I,1)=120
02840   U(I,2)=60
02850   U(I,5)=300
02860   U(I,6)=240
02870    FOR K=1 TO 4
02880    S(I,K)=1
02890    S(I,K+4)=100
02900    NEXT K
02910 R=3300+FNR(1000)
02920   B=FNA(FNR(360))
02930   X(I)=R*COS(B)
02940   Y(I)=R*SIN(B)
02950 Z(I,6)=275
02955 
02960   NEXT I
02970  REM  (FEDERATION EXCEPTIONS)
02980  C(1)=D(1)=0
02990  E(1)=1
03000 F(1)=450
03010  H(1)=530
03020  J(1)=0
03030  X(1)=Y(1)=0
03040  Z(1,6)=450
03045 A(J)=14
03050  I=0
03060  REM  --------------------TREK.0-------------------------------
03067  
03070  REM
03075 PRINT "CAPTAIN ";N$;": CODE 29 WILL GIVE YOU A COMMAND LIST"
03080  I=I+1
03090  IF I>10 THEN 3290
03100  IF I(I)=0 THEN 3080
03110  IF I(I)>10 THEN 3080
03120  IF Z(I,6)=0 THEN 3080
03130  M=V=I(I)
03140  V$=A0$(V)
03150  M$=V$
03160  IF I(I)>1 THEN 3330
03170 PRINT
03180  PRINT N$;":  CODE [1-29] ";
03190  T=TIM
03200  INPUT O
03210  IF TIM-T<300 THEN 3240
03220  PRINT "**TIME**"
03230  GOTO 3080
03240  IF INT((O-1)*.1)+1<1 THEN 3070
03250  IF INT((O-1)*.1)+1>3 THEN 3070
03260  REM  BRANCH TO CORRECT COMMAND SECTION
03270  ON INT((O-1)*.1)+1 GOTO 7620,11010,14600
03280  REM  BRANCH TO MOVEMENT SECTION
03290  GOTO 16570
03300  REM
03310  REM
03320  REM
03330  REM          ENEMY STRATEGY BY WILLIAM CHAR
03340  REM          MAIN VERSION, 25 NOVEMBER 1973
03350  J1=J=1
03360  R=FNS(X)
03370  GOSUB 20090
03380  B2=FNC(B-C(I))
03390  IF O1<1 THEN 3460
03400  IF O1>5 THEN 3460
03410  ON O1 GOTO 3420,7540,7540,4660,4660
03420  B(I)=1
03430  D(I)=0
03440  GOTO 3080
03450  REM  -- DEFENSELESS RUSE EFFECTS --
03460  IF P1<1 THEN 3730
03470  IF P1>5 THEN 3730
03480  ON P1 GOTO 3490,3530,3600,3650,3650
03490  IF .3>RND THEN 3520
03500  PRINT "SULU:  NO APPARENT CHANGE IN THE ENEMY'S ACTIONS."
03510  GOTO 3710
03520  P1=2
03530  ON FNR(2) GOTO 3540,3570
03540  J(I)=-J
03550  B(I)=1
03560  GOTO 3730
03570  J(I)=J
03580  B(I)=1
03590  GOTO 3730
03600  PRINT "SULU:  THE ";M$;" ";
03610  IF J(I)>1 THEN 3640
03620  PRINT "IS TURNING AWAY."
03630  GOTO 3650
03640  PRINT "IS CAUTIOUSLY ADVANCING."
03650  IF ABS(A(J))>1 THEN 3710
03660  IF R<200 THEN 3710
03670   FOR K=1 TO 4
03680   IF S(J,K)<>0 THEN 3710
03690   NEXT K
03700  GOTO 3730
03710  P1=6
03720  REM  -- CORBOMITE BLUFF EFFECTS --
03730  IF P2<1 THEN 4010
03740  IF P2>5 THEN 4010
03750  ON P2 GOTO 3760,3940,3970,3970,3970
03760  X=.4
03770  IF R$<>"Romulan" THEN 3790
03780  X=.6
03790  IF X>RND THEN 3870
03800  PRINT "UHURA:  MESSAGE COMING IN FROM THE ";R$;"S."
03810  PRINT N$;":  PUT IT ON AUDIO."
03820  ON FNR(3) GOTO 3830,3850,3845
03830  PRINT S$;":  HA, HA, HA, ";N$;".  YOU LOSE."
03840  GOTO 3990
03845  PRINT S$;":CAPTAIN ";N$;", WE DO NOT WANT TO DIE PLEASE"
03846  PRINT "FOR THE SAKE OF HUMANITY,CEASE THIS DESTRUCTION"
03847  GOTO 3990
03850  PRINT S$;":  I FELL FOR THAT THE LAST TIME WE MET, IDIOT!"
03860  GOTO 3990
03870  PRINT "SPOCK:  ";R$;"S GIVING GROUND, CAPTAIN.  OBVIOUSLY, THEY"
03880  PRINT "   TAPPED IN AS YOU EXPECTED THEM TO."
03890  PRINT N$;":  A LOGICAL ASSUMPTION, MR. SPOCK.  ARE THEY STILL"
03900  PRINT "   RETREATING?"
03910  PRINT "SPOCK:  YES, ";O$;"."
03920  PRINT N$;":  GOOD.  ALL HANDS, STAND BY."
03930  P2=2
03940  J(I)=-J
03950  B(I)=3+FNR(7)
03960  GOTO 4010
03970  IF ABS(A(J))>2 THEN 3990
03980  GOTO 4010
03990  P2=6
04000  REM  -- SURRENDER --
04010  IF P3<1 THEN 4330
04020  IF P3>5 THEN 4330
04030  ON P3 GOTO 4040,4190,4220,4220,4220
04040  X=.5
04050  IF R$<>"Romulan" THEN 4080
04060  X=.05
04070  PRINT "CHEKOV:  THE ";R$;"S DO NOT TAKE SURVIVORS."
04080  IF X>RND THEN 4140
04090  ON FNR(2) GOTO 4100,4120
04100  PRINT S$;":  PREPARE TO DIE, CHICKEN ";N$;"!"
04110  GOTO 4310
04120  PRINT "UHURA:  NO REPLY FROM THE ";R$;"S."
04130  GOTO 4310
04140  PRINT "UHURA:  MESSAGE COMING IN FROM THE ";M$;"."
04150  PRINT S$;":  ON BEHALF OF THE ";R$;" EMPIRE, I ACCEPT YOUR SURRENDER."
04160  PRINT "   YOU HAVE FIVE SECONDS TO DROP YOUR SHIELDS, CUT"
04170  PRINT "   WARP, AND PREPARE TO BE BOARDED."
04180  P3=2
04190  J(I)=J
04200  B(I)=2
04210  GOTO 4330
04220   FOR K=1 TO 4
04230   IF S(J,K)<>0 THEN 4660
04240   NEXT K
04250  IF R>400 THEN 4270
04260  B(I)=1
04270  IF R>200 THEN 4660
04280  IF ABS(A(J))>1 THEN 4660
04290  O1=4
04300  GOTO 4660
04310  P3=6
04320  REM  -- ENEMY SURRENDER CONTEMPLATION --
04330  IF P4<1 THEN 4560
04340  IF P4>2 THEN 4560
04350  ON P4 GOTO 4360,4470
04360   FOR L=2 TO 10
04370   IF I(L)>=10 THEN 4390
04380   IF Z(L,6)>100 THEN 4530
04390   NEXT L
04400  X=.5
04410  IF R$<>"Romulan" THEN 4430
04420  X=.05
04430  IF X<RND THEN 4530
04440  PRINT S$;":  AS MUCH AS I HATE TO, CAPTAIN ";N$;", WE WILL SURRENDER."
04450  PRINT "   WE ARE DROPPING SHIELDS.  YOU MAY BOARD US."
04460  P4=2
04470   FOR K=1 TO 4
04480   S(I,K)=0
04490   NEXT K
04500  B(I)=0
04510  O1=5
04520  GOTO 4660
04530  PRINT S$;":  YOU MUST BE JOKING, CAPTAIN ";N$;".  WHY DON'T YOU"
04540  PRINT "   SURRENDER?"
04550  P4=6
04560  IF P1<=0 THEN 4580
04570  IF P1<6 THEN 4660
04580  IF P2<=0 THEN 4600
04590  IF P2<6 THEN 4660
04600  IF P3<=0 THEN 4620
04610  IF P3<6 THEN 4660
04620  IF P4<=0 THEN 4640
04630  IF P4<6 THEN 4660
04640  GOTO 4950
04650  REM  -- UNSPORTSMANLIKE FIRING --
04660   FOR K=1 TO K1
04670   IF M(J,K)>99 THEN 4830
04680   NEXT K
04690   FOR K=1 TO K2
04700   IF T(J,K)>99 THEN 4830
04710   NEXT K
04720  IF P1<=0 THEN 4740
04730  IF P1<6 THEN 3080
04740  IF P2<=0 THEN 4760
04750  IF P2<6 THEN 3080
04760  IF P3<=0 THEN 4780
04770  IF P3<6 THEN 3080
04780  IF P4<=0 THEN 4800
04790  IF P4<6 THEN 3080
04800  IF O1=4 THEN 3080
04810  IF O1=5 THEN 3080
04820  GOTO 4950
04830  PRINT S$;":  HOW DARE YOU FIRE UPON US!  WE ARE RESUMING OUR"
04840  PRINT "   ATTACK!"
04850  O1=0
04860  IF P1=0 THEN 4880
04870  P1=6
04880  IF P2=0 THEN 4900
04890  P2=6
04900  IF P3=0 THEN 4920
04910  P3=6
04920  IF P4=0 THEN 4950
04930  P4=6
04940  REM     ----- RESUMPTION OF NORMAL PLAY -----
04950   FOR J=1 TO I1
04960   IF I(J)=I+20 THEN 5010
04970   IF I(J)=0 THEN 5010
04980   IF I(J)<21 THEN 5010
04990   IF I(J)>30 THEN 5010
05000   GOTO 5030
05010   NEXT J
05020  GOTO 5090
05030  GOSUB 20090
05040  C(I)=FNC(B+90)
05050  J(I)=0
05060  A(I)=9+FNR(2)
05070  GOTO 5210
05080  REM  (TORPEDOES NEAR?)
05090   FOR J=1 TO I1
05100   IF I(J)=I+30 THEN 5150
05110   IF I(J)=0 THEN 5150
05120   IF I(J)<31 THEN 5150
05130   IF I(J)>40 THEN 5150
05140   GOTO 5170
05150   NEXT J
05160  GOTO 5210
05170  GOSUB 20090
05180  C(I)=FNC(B+90)
05190  J(I)=0
05200  A(I)=3+FNR(2)
05210  J=J1
05220  IF R>3000 THEN 6490
05230  IF R>1200 THEN 5760
05240  REM  --CLOSE RANGE--
05250  REM  (FIRE PHASERS?)
05260  M(I,K1+1)=10
05270  L=0
05280   FOR K=1 TO K1
05290   IF M(I,K)<0 THEN 5340
05300   GOSUB 20770
05310   IF F<10 THEN 5340
05320   M(I,K)=M(I,K)+100
05330   L=L+1
05340   NEXT K
05350  IF L<>0 THEN 6950
05360  REM  (PROBE NEAR)
05370   FOR J=1 TO I1
05380   IF I(J)=0 THEN 5420
05390   IF I(J)<21 THEN 5420
05400   IF I(J)>30 THEN 5420
05410   IF SQR((X(I)-X(J))^2+(Y(I)-Y(J))^2)<1750 THEN 6990
05420   NEXT J
05430  J=J1
05440  REM  (FEDERATION BEHIND)
05450  IF B2<=135 THEN 5470
05460  IF B2<225 THEN 6990
05470  REM  (PHASERS LOCKED)
05480  L=0
05490   FOR K=1 TO K1
05500   IF M(I,K)<0 THEN 5540
05510   IF M(I,K)=J THEN 5540
05520   M(I,K)=J
05530   L=1
05540   NEXT K
05550  IF L<>0 THEN 3080
05560  REM  (LAUNCH PROBE?)
05570  IF B2<90 THEN 5630
05580  IF B2>270 THEN 5630
05590  IF Z(I,3)<>0 THEN 5620
05600  IF F(I)<=10 THEN 5620
05610  IF ABS(A(J))<=1 THEN 7090
05620  REM  (SELF-DESTRUCT?)
05630  IF F(I)>=10 THEN 5660
05640  IF G(I)>=4 THEN 5660
05650  IF K(I)<10000-5/D1 THEN 7250
05660  REM  (SET COURSE)
05670  IF J(I)<>J THEN 5690
05680  IF A(I)+ABS(A(J))<3 THEN 5780
05690  B(I)=ABS(A(J))
05700  J(I)=J
05710  IF Z(I,4)=0 THEN 3080
05720  REM  (TIME TO RUN?)
05730  IF ABS(B(I))<1 THEN 5780
05740  B(I)=-.99
05750  GOTO 3080
05760  REM  --MEDIUM RANGE--
05770  REM  (FIRE TORPEDOES?)
05780   FOR J=2 TO N
05790   IF J=I THEN 5860
05800   IF I(J)>10 THEN 5860
05810   GOSUB 20090
05820   B1=FNC(B-C(I))
05830   IF B1<5 THEN 5950
05840   IF B1>335 THEN 5950
05850   IF SQR((X(I)-X(J))^2+(Y(I)-Y(J))^2)<300 THEN 5950
05860   NEXT J
05870  L=0
05880   FOR K=1 TO K2
05890   IF T(I,K)<1 THEN 5940
05900   IF V(I,K)<1 THEN 5940
05910   T(I,K)=T(I,K)+100
05920   L=L+1
05930   IF L>FNR(6) THEN 7310
05940   NEXT K
05950  J=J1
05960  REM  (PHASERS LOCKED)
05970  L=0
05980   FOR K=1 TO K1
05990   IF M(I,K)<0 THEN 6030
06000   IF M(I,K)=J THEN 6030
06010   M(I,K)=J
06020   L=1
06030   NEXT K
06040  IF L<>0 THEN 3080
06050  REM  (TO RUN, OR NOT TO RUN)
06060  IF Z(I,4)=0 THEN 6160
06070  IF ABS(A(J)) >= 1 THEN 7540
06080   FOR K=1 TO K1
06090   IF M(I,K) >= 0 THEN 6160
06100   NEXT K
06110   FOR K=1 TO K2
06120   IF T(I,K) >= 0 THEN 6160
06130   NEXT K
06140  GOTO 7540
06150  REM  (PURSUED, BEHIND, LOW POWER:  JETTISON ENGINEERING)
06160  IF F(I)>10 THEN 6220
06170  IF G(I)>4 THEN 6220
06180  IF J(J)*A(J)<=0 THEN 6210
06190  IF Z(I,3)<>0 THEN 6210
06200  IF Z(I,5)=0 THEN 7360
06210  REM  (PURSUED, BEHIND, SLOW:  L^AUNCH PROBE)
06220  IF B2<90 THEN 6280
06230  IF B2>270 THEN 6280
06240  IF J(J)*A(J)<=0 THEN 6270
06250  IF F(I)<=10 THEN 6270
06260  IF Z(I,3)=0 THEN 7090
06270  REM  (SCAN?)
06280  IF B2<=135 THEN 6300
06290  IF B2<225 THEN 7510
06300  REM  (FED DESTRUCTING?)
06310  IF K(J)>10000-10/D1 THEN 6990
06320  REM  (SET COURSE)
06330  IF B(I)<=ABS(A(J))+1 THEN 6350
06340  IF J(I)=J THEN 6500
06350  B(I)=ABS(A(J))+FNR(4)
06360  IF B(I)<11 THEN 6380
06370  B(I)=11
06380  IF Z(I,4)=0 THEN 6400
06390  B(I)=.99
06400  ON FNR(2) GOTO 6410,6440
06410  REM  DIRECT COURSE
06420  J(I)=J
06430  GOTO 6700
06440  REM  PARALLEL COURSE
06450  D(I)=D(J)
06460  J(I)=0
06470  GOTO 6700
06480  REM  --DISTANT RANGE--
06490  REM  (LOW POWER?)
06500  IF F(I)>=10 THEN 6520
06510  IF G(I)<4.5 THEN 7540
06520  IF Z(I,4)<>0 THEN 7540
06530  REM  (FED DESTRUCTING?)
06540  IF K(J)>10000-10/D1 THEN 6990
06550  REM  (ATTACK?)
06560  J(I)=J
06570  IF F(I)<5 THEN 6660
06580  IF B2<=60 THEN 6600
06590  IF B2<300 THEN 6670
06600  IF B(I)>ABS(A(J))+2 THEN 6700
06610  B(I)=ABS(A(J))+FNR(2)+2
06620  IF B(I)<11 THEN 6640
06630  B(I)=11
06640  PRINT "SULU:  ";M$;" ATTACKING."
06650  GOTO 6700
06660  IF B(I)<1 THEN 6700
06670  B(I)=0
06680  GOTO 6700
06690  REM  (TUBES LOADED?)
06700  L=0
06710   FOR K=1 TO K2
06720   IF T(I,K)<0 THEN 6810
06730   IF V(I,K) >= 10 THEN 6810
06740   Q=10-V(I,K)
06750   IF Q<F(I) THEN 6770
06760   Q=F(I)
06770   F(I)=F(I)-Q
06780   H(I)=H(I)-Q
06790   V(I,K)=V(I,K)+Q
06800   L=L+1
06810   NEXT K
06820  IF L<>0 THEN 3080
06830  REM  (TUBES LOCKED?)
06840  L=0
06850   FOR K=1 TO K2
06860   IF T(I,K)<0 THEN 6900
06870   IF T(I,K)=J THEN 6900
06880   T(I,K)=J
06890   L=L+1
06900   NEXT K
06910  IF L<>0 THEN 3080
06920  GOTO 7510
06930  REM     ----- COMMAND EXECUTION -----
06940  REM  (FIRING PHASERS)
06950  M(I,K1+1)=10
06960  M(I,K1+2)=100
06970  GOTO 3080
06980  REM  (TAKE EVASIVE ACTION)
06990  PRINT M$;" TAKING EVASIVE ACTION."
07000  B(I)=2+FNR(8)
07010  D(I)=FNR(360)
07020  IF Z(I,4)<>0 THEN 7050
07030  J(I)=0
07040  GOTO 3080
07050  J(I)=J
07060  B(I)=.99
07070  GOTO 3080
07080  REM  (LAUNCH PROBE)
07090  GOSUB 20220
07100  PRINT M$;" LAUNCHING PROBE";I3
07110  A(I3)=B(I3)=2
07120  F(I3)=30
07130  IF F(I3)<F(I) THEN 7150
07140  F(I3)=F(I)
07150  F(I)=F(I)-F(I3)
07160  H(I)=H(I)-F(I3)
07170  I(I3)=I(I)+20
07180  J(I3)=J
07190  K(I3)=10000-15/D1
07200  L(I3)=200+FNR(300)
07210  X(I3)=X(I3)+A(I3)*100*COS(FNA(B))*D1
07220  Y(I3)=Y(I3)+A(I3)*100*SIN(FNA(B))*D1
07230  GOTO 3080
07240  REM  (SELF-DESTRUCT)
07250  PRINT "SPOCK:  THE ";M$;" IS OVERLOADING WHAT REMAINS OF ITS ANTI-"
07260  PRINT "   MATTER PODS--OBVIOUSLY A SUICIDAL GESTURE.  DETONATION"
07270  PRINT "   IN FIVE SECONDS."
07280  K(I)=10000-5/D1
07290  GOTO 3080
07300  REM  (FIRE TORPEDOES)
07310 T(I,K2+1)=3
07320 T(I,K2+2)=4
07330  T(I,K2+3)=101
07340  GOTO 3080
07350  REM  (JETTISON ENGINEERING)
07360  PRINT "SPOCK:  SENSORS INDICATE DEBRIS BEING LEFT BY THE ";M$;"."
07370  PRINT "   INSUFFICIENT MASS?"
07380  GOSUB 20220
07390  A(I3)=A(I)
07400  B(I3)=0
07410  B(I)=.9*SGN(A(I))
07420  C(I3)=D(I3)=C(I)
07430  F(I3)=F(I)
07440  F(I)=G(I)=H(I)=0
07450  I(I3)=I(I)+10
07460  K(I3)=10000-15/D1
07470  L(I3)=500
07480  Z(I,3)=Z(I,4)=Z(I,5)=1
07490  GOTO 3080
07500  REM  (SCAN)
07510  PRINT "SPOCK:  WE'RE BEING SCANNED BY THE ";M$;"."
07520  GOTO 3080
07530  REM  (RUN)
07540  IF B(I)<0 THEN 3080
07550  PRINT "SULU:  THE ";M$;" IS RETREATING."
07560  B(I)=-.99
07570  J(I)=J
07580  GOTO 3080
07590  REM 
07600  REM  ----------------------TREK.1----------------------------
07610  REM
07620  ON O GOTO 7630,7920,8160,8410,8660,8920,9180,9490,9790,10200
07630  REM  ----- (1) FIRE PHASERS -----
07640  PRINT "   FIRE PHASERS [1234] ";
07650  GOSUB 10790
07660  IF W=0 THEN 10640
07670  PRINT "   SPREAD [10-45] ";
07680  T=TIM
07690  INPUT B
07700  IF TIM-T>70 THEN 10640
07710  IF B<10 THEN 10660
07720  IF B>45 THEN 10660
07730  M(I,5)=B
07740  L1=0
07750   FOR L=1 TO W
07760   K=W(L)
07770   IF K<1 THEN 7840
07780   IF K>K1 THEN 7840
07790   IF M(I,K)<0 THEN 7840
07800   IF M(I,K) >= 100 THEN 7880
07810   M(I,K)=M(I,K)+100
07820   GOSUB 20390
07830   IF M(I,K) >= 100 THEN 7880
07840   IF L1<>0 THEN 7870
07850   PRINT "COMPUTER:  PHASER(S)  ";
07860   L1=1
07870   PRINT K;
07880   NEXT L
07890  IF L1=0 THEN 10780
07900  PRINT "UNABLE TO FIRE."
07910  GOTO 3080
07920  REM  ----- (2) FIRE TUBES -----
07930  PRINT "   FIRE TUBES [123456] ";
07940  GOSUB 10790
07950  IF W=0 THEN 10640
07960  L1=0
07970   FOR L=1 TO W
07980   K=W(L)
07990   IF K<1 THEN 8120
08000   IF K>K2 THEN 8120
08010 IF T(I,K)<0 THEN 8070
08020  IF V(I,K)=0 THEN 8070
08030   IF T(I,K) >= 100 THEN 8120
08040   T(I,K)=T(I,K)+100
08050   GOSUB 20580
08060   IF T(I,K) >= 100 THEN 8120
08070 L1=6
08080  GOTO 3080
08090   PRINT "COMPUTER:  TUBE(S)  ";
08100   L1=1
08110   PRINT K;
08120   NEXT L
08140  PRINT "THEY'RE GOING TO HATE YOU FOR THAT"
08150  GOTO 3080
08160  REM  ----- (3) LOCK PHASERS -----
08170  IF Z(I,1)<>0 THEN 10700
08180  PRINT "   LOCK PHASERS [1-4] ";
08190  GOSUB 10790
08200  IF W=0 THEN 10640
08210  PRINT "   ON [WHOM] ";
08220  GOSUB 14430
08230  IF V1>10 THEN 10680
08240  L1=0
08250   FOR L=1 TO W
08260   K=W(L)
08270   IF K<1 THEN 8330
08280   IF K>K1 THEN 8330
08290   IF M(I,K)<0 THEN 8330
08300   M(I,K)=V1
08310   GOSUB 20390
08320   IF M(I,K)>0 THEN 8370
08330   IF L1<>0 THEN 8360
08340   PRINT "COMPUTER:  PHASER(S)  ";
08350   L1=1
08360   PRINT K;
08370   NEXT L
08380  IF L1=0 THEN 10780
08390  PRINT "UNABLE TO LOCK."
08400 GOTO 3170
08410  REM  ----- (4) LOCK TUBES -----
08420  IF Z(I,1)<>0 THEN 10700
08430  PRINT "   LOCK TUBES [1-6] ";
08440  GOSUB 10790
08450  IF W=0 THEN 10640
08460  PRINT "   ON [WHOM] ";
08470  GOSUB 14430
08480  IF V1>10 THEN 10680
08490  L1=0
08500   FOR L=1 TO W
08510   K=W(L)
08520   IF K<1 THEN 8580
08530   IF K>K2 THEN 8580
08540   IF T(I,K)<0 THEN 8580
08550   T(I,K)=V1
08560   GOSUB 20580
08570   IF T(I,K)<>0 THEN 8620
08580   IF L1<>0 THEN 8610
08590   PRINT "COMPUTER:  TUBE(S)  ";
08600   L1=1
08610   PRINT K;
08620   NEXT L
08630 IF L1=0 THEN 3170
08640  PRINT "UNABLE TO LOCK."
08650 GOTO 3170
08660  REM  ----- (5) TURN PHASERS -----
08670  PRINT "   TURN PHASERS [1-4] ";
08680  GOSUB 10790
08690  PRINT "   TO [0-360] ";
08700  T=TIM
08710  INPUT B
08720  IF TIM-T>100 THEN 10640
08730  IF B<0 THEN 10680
08740  IF B >= 360 THEN 10680
08750  L1=0
08760   FOR L=1 TO W
08770   K=W(L)
08780   IF K<1 THEN 8840
08790   IF K>K1 THEN 8840
08800   IF M(I,K)<0 THEN 8840
08810   M(I,K)=0
08820   N(I,K)=B
08830   GOTO 8880
08840   IF L1<>0 THEN 8870
08850   PRINT "COMPUTER:  PHASER(S)  ";
08860   L1=1
08870   PRINT K;
08880   NEXT L
08890  IF L1=0 THEN 10780
08900  PRINT "UNABLE TO TURN."
08910 GOTO 3170
08920  REM  ----- (6) TURN TUBES -----
08930  PRINT "   TURN TUBES [1-6] ";
08940  GOSUB 10790
08950  PRINT "   TO [0-360] ";
08960  T=TIM
08970  INPUT B
08980  IF TIM-T>100 THEN 10640
08990  IF B<0 THEN 10680
09000  IF B >= 360 THEN 10680
09010  L1=0
09020   FOR L=1 TO W
09030   K=W(L)
09040   IF K<1 THEN 9100
09050   IF K>K2 THEN 9100
09060   IF T(I,K)<0 THEN 9100
09070   T(I,K)=0
09080   U(I,K)=B
09090   GOTO 9140
09100   IF L1<>0 THEN 9130
09110   PRINT "COMPUTER:  TUBE(S)  ";
09120   L1=1
09130   PRINT K;
09140   NEXT L
09150  IF L1=0 THEN 10780
09160  PRINT "UNABLE TO TURN."
09170 GOTO 3170
09180  REM  ----- (7) PHASER STATUS -----
09190  PRINT "PHASERS"
09200  PRINT "CONTROL";
09210   FOR K=1 TO K1
09220   PRINT TAB(8*K+2);
09230   ON SGN(M(I,K))+2 GOTO 9240,9260,9280
09240   PRINT "DAMAGED";
09250   GOTO 9310
09260   PRINT "MANUAL";
09270   GOTO 9310
09280   V=I(M(I,K))
09290   V$=A0$(V)
09300   PRINT LEFT$(V$,7);
09310   NEXT K
09320  PRINT 
09330  PRINT "TURNED";
09340   FOR K=1 TO K1
09350   PRINT TAB(8*K+2);INT(N(I,K));
09360   NEXT K
09370  PRINT "  FIRING $S=";M(I,6)
09380  PRINT "LEVEL";
09390   FOR K=1 TO K1
09400   PRINT TAB(8*K+2);INT(Q(I,K));
09410   NEXT K
09420  PRINT 
09430  PRINT "CHARGE";
09440   FOR K=1 TO K1
09450   PRINT TAB(8*K+2);INT(R(I,K));
09460   NEXT K
09470  PRINT 
09480 GOTO 3170
09490  REM  ----- (8) TUBE STATUS -----
09500  PRINT "TORPEDOES"
09510  PRINT "CONTROL";
09520   FOR K=1 TO K2
09530   PRINT TAB(8*K+2);
09540   IF T(I,K)>0 THEN 9600
09550   IF T(I,K)=0 THEN 9580
09560   PRINT "DAMAGED";
09570   GOTO 9630
09580   PRINT "MANUAL";
09590   GOTO 9630
09600   V=I(T(I,K))
09610   V$=A0$(V)
09620   PRINT LEFT$(V$,7);
09630   NEXT K
09640  PRINT 
09650  PRINT "TURNED";
09660   FOR K=1 TO K2
09670   PRINT TAB(8*K+2);INT(U(I,K));
09680   NEXT K
09690  PRINT 
09700  PRINT "LEVELS";
09710   FOR K=1 TO K2
09720   PRINT TAB(8*K+2);INT(V(I,K));
09730   NEXT K
09740  PRINT 
09750  PRINT "LAUNCH SPEED";T(I,7)
09760  PRINT "  TIME DELAY";T(I,8)
09770  PRINT "  PROX DELAY";T(I,9)
09780 GOTO 3170
09790  REM  ----- (9) LOAD/UNLAOD TUBES -----
09800  PRINT "   [LOAD OR UNLOAD] ";
09810  T=TIM
09820  INPUT X$
09830  IF TIM-T>100 THEN 10640
09840  X=1
09850  IF LEFT$(X$,1)="L" THEN 9880
09860  X=-1
09870  IF LEFT$(X$,1)<>"U" THEN 10660
09880  PRINT "   TUBES [1-6] ";
09890  GOSUB 10790
09900  IF W=0 THEN 10660
09910   FOR L=1 TO W
09920   K=W(L)
09930   IF K<1 THEN 10100
09940   IF K>K2 THEN 10100
09950   IF T(I,K)<0 THEN 10100
09960   IF X>0 THEN 10040
09970   Y=H(I)-F(I)
09980   IF V(I,K)>Y THEN 10000
09990   Y=V(I,K)
10000   V(I,K)=V(I,K)-Y
10010   F(I)=F(I)+Y
10020   H(I)=H(I)+Y
10030   GOTO 10100
10040   Y=10-V(I,K)
10050   IF F(I)>Y THEN 10070
10060   Y=F(I)
10070   V(I,K)=V(I,K)+Y
10080   F(I)=F(I)-Y
10090   H(I)=H(I)-Y
10100   NEXT L
10110  PRINT "SCOTT:  TUBE UNITS NOW  ";
10120   FOR K=1 TO K2
10130   IF T(I,K)<0 THEN 10160
10140   PRINT INT(V(I,K));
10150   GOTO 10170
10160   PRINT " --   ";
10170   NEXT K
10180  PRINT "FUEL @";INT(F(I))
10190 GOTO 3170
10200  REM ----- (10) LAUNCH PROBE -----
10210  IF Z(I,3)<>0 THEN 10720
10220  PRINT "SCOTT:  ";F(I);"PODS AVAILABLE."
10230  IF F(I)<10 THEN 10740
10240  T=TIM
10250  PRINT N$;":  NUMBER OF PODS TO LAUNCH [10+] IS ";
10260  INPUT Q1
10270  PRINT "   SET TIME DELAY TO [0-15] ";
10280  INPUT Q2
10290  PRINT "   SET PROXIMITY DELAY TO [50+] ";
10300  INPUT Q3
10310  IF TIM-T>300 THEN 10640
10320  IF Q1<10 THEN 10680
10330  IF Q1>F(I) THEN 10680
10340  IF Q2<0 THEN 10680
10350  IF Q2>15 THEN 10680
10360  IF Q3<50 THEN 10680
10370  GOSUB 20220
10380  PRINT "   LAUNCH TOWARDS [WHOM, IF ANYONE] ";
10390  GOSUB 14430
10400  IF V1>10 THEN 10460
10410  J=V1
10420  GOSUB 20090
10430  J(I3)=V1
10440  C(I3)=D(I3)=B
10450  GOTO 10520
10460  PRINT "   COURSE [0-360]  ";
10470  T=TIM
10480  INPUT D(I3)
10490  IF TIM-T>100 THEN 10640
10500  IF D(I3)<0 THEN 10680
10510  IF D(I3) >= 360 THEN 10680
10520  A(I3)=B(I3)=2
10530  F(I3)=Q1
10540  F(I)=F(I)-Q1
10550  H(I)=H(I)-Q1
10560  I(I3)=I(I)+20
10570  K(I3)=10000-Q2/D1
10580  L(I3)=Q3
10590  X(I3)=X(I)+A(I3)*COS(C(I3))*20
10600  Y(I3)=Y(I)+A(I3)*SIN(C(I3))*20
10610  PRINT "SCOTT:  PROBE #  ";I3;"AWAY."
10620  GOTO 3080
10630  REM     ----- ERROR MESSAGES -----
10640  PRINT "*TIME"
10650  GOTO 3080
10660  PRINT "CHEKOV:  WHAT?"
10670  GOTO 3080
10680  PRINT "SPOCK:  BAD PARAMETER(S)."
10690  GOTO 3080
10700  PRINT "SPOCK:  QUITE IMPOSSIBLE, ";O$;", OUR COMPUTER IS DEAD."
10710  GOTO 3080
10720  PRINT "SCOTT:  PROBE LAUNCHER DESTROYED."
10730  GOTO 3080
10740  PRINT "SCOTT:  WE'VE NOT ENOUGH POWER."
10750  REM
10760  REM     ----- EXIT -----
10770  REM
10780  GOTO 3080
10790  REM       ----- CONVERSION SUBROUTINE -----
10800  W=0
10810  T=TIM
10820  INPUT X$
10830  IF TIM-T>100 THEN 10970
10840  IF LEN(X$)=0 THEN 10970
10850  Y$="0123456789"
10860   FOR V2=1 TO 10
10865   W(V2)=0
10867   NEXT V2
10870   FOR V2=1 TO LEN(X$)
10880   IF MID$(X$,V2,1)=" "THEN 10960
10890   IF MID$(X$,V2,1)="," THEN 10960
10900    FOR V3=1 TO 10
10910    IF MID$(X$,V2,1)=MID$(Y$,V3,1) THEN 10940
10920    NEXT V3
10930   GOTO 10960
10940   W=W+1
10950   W(W)=V3-1
10960   NEXT V2
10970  RETURN
10980  REM 
10990  REM  -----------------------TREK.2---------------------------
11000  REM
11010  ON O-10 GOTO 11020,11700,12080,12610,12610,12880,13070,13070,13550,13880
11020  REM  ----- (11) PROBE CONTROL -----
11030  K=0
11040   FOR J=1 TO I1
11050   IF I(J)<>I(I)+20 THEN 11220
11060   IF K<>0 THEN 11100
11070   PRINT 
11080   PRINT "PROBE BEARNG RANGE  COURSE TIME  PROX UNITS  TARGET"
11090   K=1
11100   GOSUB 20090
11110   R=SQR(X*X+Y*Y)
11120   PRINT J;INT(B);INT(R);TAB(21);INT(C(J));INT((10000-K(J))*D1);
11130   PRINT INT(L(J));INT(F(J));
11140   IF J(J)=0 THEN 11190
11150   V=I(J(J))
11160   V$=A0$(V)
11170   PRINT V$
11180   GOTO 11200
11190   PRINT "NONE"
11200    FOR Q=1 TO 1000
11210    NEXT Q
11220   NEXT J
11230  PRINT 
11240  IF K<>0 THEN 11270
11250  PRINT "SULU:  WHAT PROBES?"
11260  GOTO 14420
11270  PRINT "CHEKOV:  DETONATE ALL PROBES?"
11280  PRINT N$;":  [YES OR NO] ";
11290  T=TIM
11300  INPUT X$
11310  IF TIM-T>180 THEN 14270
11320  IF LEFT$(X$,1)="N" THEN 11390
11330  PRINT "CHEKOV:  AYE, ";O$;"."
11340   FOR J=1 TO I1
11350   IF I(J)<>I(I)+20 THEN 11370
11360   K(J)=10000
11370   NEXT J
11380  GOTO 14420
11390  PRINT "   CONTROL PROBE [#] ";
11400  T=TIM
11410  INPUT J
11420  IF TIM-T>70 THEN 14270
11430  IF J<1 THEN 14270
11440  IF J>I1 THEN 14270
11450  IF I(J)<>I(I)+20 THEN 14270
11460  PRINT "CHEKOV:  DETONATE IT?"
11470  PRINT N$;":  [YES OR NO] ";
11480  T=TIM
11490  INPUT X$
11500  IF TIM-T>90 THEN 14270
11510  IF LEFT$(X$,1)="N" THEN 11540
11520  K(J)=10000
11530  GOTO 14420
11540  PRINT "   LOCK IT ONTO [WHOM] ";
11550  GOSUB 14430
11560  IF V1>10 THEN 11600
11570  PRINT "CHEKOV:  LOCKING."
11580  J(J)=V1
11590  GOTO 14420
11600  PRINT "   SET IT TO COURSE [0-360] ";
11610  T=TIM
11620  INPUT C
11630  IF TIM-T>70 THEN 14270
11640  IF C<0 THEN 14290
11650  IF C >= 360 THEN 14290
11660  PRINT "SULU:  SETTING IN NEW COURSE."
11670  D(J)=C
11680  J(J)=0
11690  GOTO 14420
11700  REM  ----- (12) *POSITION REPORT -----
11710  REM  (LONGEST NAME)
11720  L=0
11730   FOR J=1 TO N
11740   V=I(J)
11750   IF V=0 THEN 11800
11760   IF V>10 THEN 11800
11770   V$=A0$(V)
11780   IF LEN(V$)<L THEN 11800
11790   L=LEN(V$)
11800   NEXT J
11810  REM  (REPORT)
11820  PRINT 
11830  PRINT TAB(L);"   WARP COURSE BEARING RANGE"
11840   FOR J=1 TO I1
11850   V=I(J)
11860   IF V=0 THEN 12050
11870   IF V>10 THEN 12050
11880   V$=A0$(V)
11890   PRINT TAB(L-LEN(V$));V$;": ";
11900   PRINT "  ";INT(10*A(J)+.5)*.1;TAB(L+8);INT(C(J)+.5);
11910   REM  IMAGE #,3D.D,6D,2X
11920   IF J=I THEN 11970
11930   GOSUB 20090
11940   R=SQR(X*X+Y*Y)
11950   PRINT " ";INT(B+.5);INT(R+.5);
11960   GOTO 12040
11970   IF J(J)=0 THEN 12040
11980   V=I(ABS(J(J)))
11990   V$=A0$(V)
12000   IF J(J)>0 THEN 12030
12010   PRINT "(ELUDING ";V$;")";
12020   GOTO 12040
12030   PRINT "(PURSUING ";V$;")";
12040   PRINT 
12050   NEXT J
12060  I=0
12070  GOTO 14420
12080  REM  ----- (13) *POSITION DISPLAY -----
12090  IF Z(I,2)<>0 THEN 14350
12100  PRINT "   DISPLAY [100-5000] ";
12110  INPUT Z
12120  IF Z < 100 THEN 12140
12130  IF Z <= 5000 THEN 12160
12140  PRINT "SPOCK:  DESIGNATE BETWEEN 100 AND 5000."
12150  GOTO 12100
12160  X=Z/15
12170  Y=Z/6
12180  Y$="                               "
12190  Z$="-------------------------------"
12200   FOR K=6 TO -6 STEP -1
12210   IF ABS(K)=6 THEN 12240
12220   X$=Y$
12230   GOTO 12250
12240   X$=Z$
12250    FOR L=1 TO I1
12260    IF  I(L)=0 THEN 12480
12270    IF I=L THEN 12480
12280    IF K<>INT((Y(L)-Y(I))/Y+.5) THEN 12480
12290    Z=INT((X(L)-X(I))/X+15.5)
12300    IF Z<1 THEN 12480
12310    IF Z>31 THEN 12480
12320    ON INT((I(L)-1)*.1)+1 GOTO 12330,12360,12380,12400
12330    V=I(L)
12340    V$=LEFT$(A0$(V),1)
12350    GOTO 12410
12360    V$="#"
12370    GOTO 12410
12380    V$="*"
12390    GOTO 12410
12400    V$=":"
12410    IF Z<>1 THEN 12440
12420    X$=V$+RIGHT$(X$,30)
12430    GOTO 12480
12440    IF Z<>31 THEN 12470
12450    X$=LEFT$(X$,30)+V$
12460    GOTO 12480
12470    X$=LEFT$(X$,Z-1)+V$+RIGHT$(X$,31-Z)
12480    NEXT L
12490   IF K<>0 THEN 12510
12500   X$=LEFT$(X$,15)+"+"+RIGHT$(X$,15)
12510    FOR L=31 TO 1 STEP -1
12520    IF MID$(X$,L,1)<>" " THEN 12560
12530    NEXT L
12540   PRINT 
12550   GOTO 12570
12560   PRINT LEFT$(X$,L)
12570   NEXT K
12580  PRINT 
12590  I=0
12600  GOTO 14420
12610  REM  ----- (14 AND 15) PURSUE OR RUN -----
12620  IF Z(I,1)<>0 THEN 14330
12630  IF O=15 THEN 12660
12640  PRINT "   SULU, PURSUE [WHOM] ";
12650  GOTO 12670
12660  PRINT "   SULU, RUN FROM [WHOM] ";
12670  GOSUB 14430
12680  IF V1>10 THEN 14270
12690 PRINT"  WARP FACTOR (-9 TO 20)";
12700  T=TIM
12710  INPUT Z
12720  IF TIM-T>90 THEN 14270
12730  PRINT 
12740  IF ABS(Z)>20 THEN 14310
12741  IF ABS(Z)=20 THEN 22501
12750  IF ABS(Z) < 1 THEN 12770
12760  IF Z(I,4)<>0 THEN 14370
12770  B(I)=Z
12780  J=V1
12790  GOSUB 20090
12800  PRINT "SULU:  AYE, ";O$;", COMING TO COURSE";
12810  IF O=15 THEN 12850
12820  PRINT INT(B)
12830  J(I)=J
12840  GOTO 14420
12850  J(I)=-J
12860  PRINT INT(FNC(B+180))
12870  GOTO 14420
12880  REM  ----- (16) MANUAL HELM -----
12890  PRINT "   HELMSMAN, COME TO COURSE [0-360] ";
12900  T=TIM
12910  INPUT Z
12920  IF TIM-T>70 THEN 14270
12930  IF Z<0 THEN 14310
12940  IF Z>360 THEN 14310
12950  D(I)=Z
12960  J(I)=0
12970  PRINT "   WARP FACTOR [-9 TO 9] ";
12980  T=TIM
12990  INPUT Z
13000  IF TIM-T>70 THEN 14270
13010 IF ABS(Z)>9 THEN 14310
13020  IF ABS(Z) < 1 THEN 13040
13030  IF Z(I,4)<>0 THEN 14370
13040  B(I)=Z
13050  PRINT "SULU:  AYE, ";O$;"."
13060  GOTO 14420
13070  REM  ----- (17 AND 18) DAMAGE/SCAN REPORT -----
13080  IF O=18 THEN 13130
13090  J=I
13100  V=I(I)
13110  V$=A0$(V)
13120  GOTO 13180
13130  IF Z(I,2)<>0 THEN 14350
13140  PRINT "   SPOCK, SCAN [WHOM] ";
13150  GOSUB 14430
13160  IF V1>10 THEN 14310
13170  J=V1
13180  PRINT 
13190  PRINT "DAMAGES TO ";V$;":"
13200  PRINT 
13210  FOR K=1 TO 4
13220   IF Z(J,K)=0 THEN 13240
13230  PRINT A3$(K);".  ";
13240   NEXT K
13250  PRINT "SURVIVORS:";Z(J,6)
13260  PRINT 
13270  PRINT "PHASERS: ";
13280   FOR K=1 TO K1
13290   IF M(J,K)<0 THEN 13320
13300   PRINT INT(Q(J,K));
13310   GOTO 13330
13320   PRINT " XX   ";
13330   NEXT K
13340  PRINT 
13350  PRINT "  TUBES: ";
13360   FOR K=1 TO K2
13370   IF T(J,K)<0 THEN 13400
13380   PRINT INT(V(J,K));
13390   GOTO 13410
13400   PRINT " XX   ";
13410   NEXT K
13420  PRINT 
13430  PRINT "SHIELDS: ";
13440   FOR K=1 TO 4
13450   PRINT INT(S(J,K)*S(J,K+4));
13460   NEXT K
13470  PRINT 
13480  PRINT 
13490  PRINT "WARP EFFICIENCY:";E(J)
13500  PRINT "REGENERATION:";G(J)
13510  PRINT "FUEL REMAINING:";INT(F(J)+.5)
13520  PRINT "FUEL CAPACITY:";INT(H(J)+.5)
13530  PRINT 
13540 GOTO 3170
13550  REM  ----- (19) POWER DISTRIBUTION -----
13560  PRINT 
13570  PRINT "SCOTT:  REGENERATION RATE IS";G(I)
13580 MAT W=ZER
13590  PRINT "   DESIGNATE SHIELD DRAIN (X,X,X,X)."
13600  PRINT N$;":  SHIELD DRAINS ARE [0-1] ";
13610  T=TIM
13620  MAT  INPUT W
13630  IF TIM-T>200 THEN 14270
13640   FOR K=1 TO 4
13650   IF W(K) < 0 THEN 13670
13660   IF W(K) <= 1 THEN 13700
13670   PRINT "MINIMUM DRAIN FOR SHIELDS IS ZERO (0), MAXIMUM IS ONE (1)."
13680   PRINT "TRY AGAIN."
13690   GOTO 13590
13700   S(I,K)=W(K)
13710   NEXT K
13720 MAT W=ZER
13730  PRINT "SCOTT:  DESIGNATE PHASER CHARGE/DISCHARGE (X,X,X,X)."
13740  PRINT N$;":  CHARGE/DISCHARGE RATES ARE [-10 TO 10] ";
13750  T=TIM
13760  MAT  INPUT W
13770  IF TIM-T>200 THEN 14270
13780   FOR K=1 TO K1
13790   IF W(K) < -10 THEN 13810
13800   IF W(K) <= 10 THEN 13840
13810   PRINT "FOR PHASERS, MAXIMUM DISCHARGE IS -10, MAXIMUM CHARGE IS 10."
13820   PRINT "TRY AGAIN."
13830   GOTO 13730
13840   R(I,K)=W(K)
13850   NEXT K
13860  PRINT 
13870 GOTO 3170
13880  REM  ----- (20) FIRING PARAMETERS -----
13890  PRINT 
13900  PRINT "CHEKOV:  RESET TUBES, ";O$;"?"
13910  PRINT N$;":  [YES OR NO] ";
13920  T=TIM
13930  INPUT X$
13940  IF TIM-T>90 THEN 14270
13950  IF LEFT$(X$,1)="N" THEN 14130
13960  T=TIM
13970  PRINT "   SET LAUNCH SPEED TO [0-12] ";
13980  INPUT Q1
13990  IF Q1<0 THEN 14290
14000  IF Q1>12 THEN 14290
14010  T(I,7)=Q1
14020  PRINT "   ...TIME DELAY TO [0-10] ";
14030  INPUT Q2
14040  IF Q2<0 THEN 14290
14050  IF Q2>10 THEN 14290
14060  T(I,8)=Q2
14070  PRINT "   ...PROXIMITY DELAY TO [0-500] ";
14080  INPUT Q3
14090  IF TIM-T>350 THEN 14270
14100  IF Q3<0 THEN 14290
14110  IF Q3>500 THEN 14290
14120  T(I,9)=Q3
14130  PRINT "CHEKOV:  RESET PHASERS, ";O$;"?"
14140  PRINT N$;":  [YES OR NO] ";
14150  T=TIM
14160  INPUT X$
14170  IF TIM-T>70 THEN 14270
14180  IF LEFT$(X$,1)="N" THEN 14420
14190  PRINT "   RESET FIRING PERCENTAGE TO [0-100] ";
14200  INPUT X
14210  PRINT 
14220  IF X<0 THEN 14310
14230  IF X>100 THEN 14310
14240  M(I,6)=X
14250  GOTO 14420
14260  REM     ----- ERROR MESSAGES -----
14270  PRINT "*TIME"
14280  GOTO 14420
14290  PRINT "CHEKOV:  WHAT?"
14300  GOTO 14420
14310  PRINT "SPOCK:  BAD PARAMETER(S)."
14320  GOTO 14420
14330  PRINT "SPOCK:  IMPOSSIBLE, ";O$;", OUR COMPUTER IS INOPERABLE."
14340  GOTO 14420
14350  PRINT "SPOCK:  OUR SENSORS ARE DAMAGED."
14360  GOTO 14420
14370  PRINT "SCOTT:  WARP DRIVE IS DEAD."
14380  GOTO 14420
14390  REM
14400  REM     ----- EXIT -----
14410  REM
14420  GOTO 3080
14430  REM          ----- NAME COMPARISON SUBROUTINE -----
14440  T=TIM
14450  INPUT X$
14460  IF TIM-T>100 THEN 14550
14470  IF LEN(X$)=0 THEN 14550
14480   FOR V1=2 TO 10
14490   V=I(V1)
14500   IF V=0 THEN 14540
14510   IF V>10 THEN 14540
14520   V$=A0$(V)
14530   IF LEFT$(X$,1)=LEFT$(V$,1) THEN 14560
14540   NEXT V1
14550  V1=11
14560  RETURN 
14570  REM 
14580  REM  -----------------------TREK.3----------------------------
14590  REM
14600  ON O-20 GOTO 14610,14760,14900,15110,15570,15700,15800,16090,16260,16390
14610  REM  ----- (21) JETTISON ENGINEERING -----
14620  PRINT "   MR. SCOTT, JETTISON OUR ENGINEERING SECTION!"
14630  IF Z(I,5)<>0 THEN 16480
14640  PRINT "SCOTT:  ENGINEERING SECTION AWAY, ";O$;"."
14650  GOSUB 20220
14660  A(I3)=A(I)
14670  B(I)=.999999
14680  B(I3)=0
14690  C(I3)=D(I3)=C(I)
14700  F(I3)=F(I)
14710  F(I)=G(I)=H(I)=0
14720  I(I3)=I(I)+10
14730  K(I3)=10000-15/D1
14740  Z(I,3)=Z(I,4)=Z(I,5)=1
14750  GOTO 16520
14760  REM  ----- (22) DETONATE ENGINEERING -----
14770  PRINT "   SCOTTY, DETONATE ENGINEERING!"
14780  PRINT "SCOTT:  ";
14790  IF Z(I,5)<>0 THEN 14820
14800  PRINT "BUT, CAPTAIN, YE KINNA DO THAT!  IT'S STILL ATTACHED!"
14810  GOTO 16520
14820   FOR J=1 TO I1
14830   IF I(J)=I(I)+10 THEN 14870
14840   NEXT J
14850  PRINT "OURS HAS ALL READY DETONATED."
14860  GOTO 16520
14870  PRINT "AYE, ";O$;"."
14880  K(J)=10000
14890  GOTO 16520
14900  REM  ----- (23) PLAY DEAD -----
14910  PRINT "   WEAPONS OFFICER, DROP SHIELDS ..."
14920  IF P1<>0 THEN 15090
14930  PRINT "   TRANSFER POWER TO [ENGINES OR PHASERS]: ";
14940  T=TIM
14950  INPUT X$
14960  IF TIM-T>100 THEN 16420
14970  L=-10
14980  IF LEFT$(X$,1)="E" THEN 15010
14990  L=10
15000  IF LEFT$(X$,1)<>"P" THEN 16440
15010   FOR K=1 TO 4
15020   S(I,K)=0
15030   NEXT K
15040   FOR K=1 TO K1
15050   R(I,K)=L
15060   NEXT K
15070  P1=1
15080  GOTO 16520
15090  PRINT "SPOCK:  ";O$;", THE ";R$;"S ARE NOT THAT STUPID."
15100  GOTO 16520
15110  REM  ----- (24) CORBOMITE BLUFF(S) -----
15120  IF RND>.5 THEN 15310
15130  PRINT "   OPEN A HAILING FREQUENCY, SHIP-TO-SHIP."
15140  PRINT "UHURA:  HAILING FREQUENCY OPEN, ";O$;"."
15150  PRINT N$;":  THIS IS THE CAPTAIN OF THE ";A0$(1);".  OUR RESPECT FOR"
15160  PRINT "   OTHER LIFE FORMS REQUIRES THAT WE GIVE YOU THIS WARNING--"
15170  PRINT "   ONE CRITICAL ITEM OF INFORMATION WHICH HAS NEVER BEEN"
15180  PRINT "   INCORPORATED INTO THE MEMORY BANKS OF ANY EARTH SHIP."
15190  PRINT "   SINCE THE EARLY YEARS OF SPACE EXPLORATION, EARTH VESSELS"
15200  PRINT "   HAVE HAD INCORPORATED IN THEM A SUBSTANCE KNOWN AS CORBOMITE."
15210  IF P2<>0 THEN 15540
15220  PRINT "      IT IS A MATERIAL AND A DEVICE WHICH PREVENTS ATTACK ON"
15230  PRINT "   US.  IF ANY DESTRUCTIVE ENERGY TOUCHES OUR VESSEL, A RE-"
15240  PRINT "   VERSE REACTION OF EQUAL STRENGTH IS CREATED, DESTROYING"
15250  PRINT "   THE ATTACKER.  IT MAY INTEREST YOU TO KNOW THAT, SINCE"
15260  PRINT "   THE INITIAL USE OF CORBOMITE FOR MORE THAN TWO OF OUR"
15270  PRINT "   CENTURIES AGO, NO ATTACKING VESSEL HAS SURVIVED THE ATTEMPT."
15280  PRINT "   DEATH HAS LITTLE MEANING TO US.  IF IT HAS NONE TO YOU,"
15290  PRINT "   THEN ATTACK US NOW.  WE GROW ANNOYED AT YOUR FOOLISHNESS."
15300  GOTO 15500
15310  PRINT "   OPEN A SPECIAL CHANNEL TO STARFLEET COMMAND."
15320  PRINT "UHURA:  AYE, SIR."
15330  PRINT N$;":  USE CODE 2."
15340  PRINT "UHURA:  BUT, CAPTAIN, ACCORDING TO OUR LAST STARFLEET"
15350  PRINT "   BULLETIN, THE ";R$;"S HAVE BROKEN CODE 2."
15360  PRINT N$;":  THAT'S AN ORDER, LIEUTENANT.  CODE 2!"
15370  PRINT "UHURA:  YES, CAPTAIN.  CODE 2."
15380  PRINT N$;":  MESSAGE FROM ";A0$(1);" TO STARFLEET COMMAND, THIS SECTOR."
15390  PRINT "   HAVE INADVERTANTLY ENCROACHED UPON ";R$;" NEUTRAL ZONE,"
15400  PRINT "   SURROUNDED AND UNDER HEAVY ";R$;" ATTACK.  ESCAPE"
15410  PRINT "   IMPOSSIBLE.  SHIELDS FAILING.  WILL IMPLEMENT DESTRUCT"
15420  PRINT "   ORDER USING CORBOMITE DEVICE RECENTLY INSTALLED.  SINCE"
15430  IF P2<>0 THEN 15540
15440  PRINT "   THIS WILL RESULT IN THE DESTRUCTION OF THE ";A0$(1);" AND"
15450  PRINT "   ALL MATTER WITHIN A 200,000 KILOMETER DIAMETER AND"
15460  PRINT "   ESTABLISH CORRESPONDING DEAD ZONE, ALL FEDERATION"
15470  PRINT "   VESSELS WILL AVOID THIS AREA FOR THE NEXT FOUR SOLAR"
15480  PRINT "   YEARS.  EXPLOSION WILL TAKE PLACE IN ONE MINUTE.  ";N$;","
15490  PRINT "   COMMANDING ";A0$(1);", OUT."
15500  PRINT "      MR. SULU.  STAND BY."
15510  PRINT "SULU:  STANDING BY."
15520  P2=1
15530  GOTO 16520
15540  PRINT "SPOCK:  ";O$;", I DON'T BELIEVE THAT THEY WILL FALL FOR"
15550  PRINT "   THAT MANUEVER AGAIN."
15560  GOTO 16520
15570  REM  ----- (25) SURRENDER ATTEMPT -----
15580  PRINT "   LIEUTENANT, OPEN A CHANNEL TO THE ";R$;"S."
15590  PRINT "UHURA:  AYE, ";O$;"."
15600  PRINT N$;":  THIS IS CAPTAIN ";N$;" OF THE U.S.S. ";A0$(1);".  WILL"
15610  PRINT "   YOU ACCEPT MY UNCONDITIONAL SURRENDER?"
15620  IF P3<>0 THEN 15680
15630  IF R$<>"Romulan" THEN 15660
15640  PRINT "SPOCK:  THE ";R$;"S HAVE NOT BEEN KNOWN TO HAVE TAKEN"
15650  PRINT "   PRISONERS."
15660  P3=1
15670  GOTO 16520
15680  PRINT "SPOCK:  THE ";R$;"S HAVE ALL READY REFUSED."
15690  GOTO 16520
15700  REM  ----- (26) ASK ENEMY TO SURRENDER -----
15710  PRINT "   LIEUTENANT, OPEN A HAILING FREQUENCY TO THE ";R$;"S."
15720  PRINT "UHURA:   HAILING FREQUENCY OPEN, ";O$;"."
15730  PRINT N$;":  THIS IS CAPTAIN ";N$;" OF THE USS ";A0$(1);".  I GIVE YOU"
15740  PRINT "   ONE LAST CHANCE TO SURRENDER BEFORE WE RESUME OUR ATTACK."
15750  IF P4<>0 THEN 15780
15760  P4=1
15770  GOTO 16520
15780  PRINT "SPOCK:  ";O$;", OUR OFFER HAS ALL READY BEEN REFUSED."
15790  GOTO 16520
15800  REM  ----- (27) SELF-DESTRUCT SEQUENCE -----
15810  PRINT "   LIEUTENANT UHURA, TIE IN THE BRIDGE TO THE MASTER"
15820  PRINT "   COMPUTER."
15830  IF Z(I,1)<>0 THEN 16460
15840  PRINT "UHURA:  AYE, ";O$;"."
15850  PRINT N$;":  COMPUTER.  DESTRUCT SEQUENCE.  ARE YOU READY TO COPY?"
15860  PRINT "COMPUTER:  WORKING."
15870  PRINT N$;":  PREPARE TO VERIFY DESTRUCT SEQUENCE, CODE 1."
15880  PRINT "   COMPUTER, THIS IS CAPTAIN ";N$;" OF THE U.S.S. ";A0$(1);"."
15890  PRINT "   DESTRUCT SEQUENCE ONE, CODE 1-1A."
15900  PRINT "COMPUTER:  VOICE AND CODE 1-1A VERIFIED AND CORRECT."
15910  PRINT "   SEQUENCE ONE COMPLETE."
15920  PRINT N$;":  MR. SPOCK?"
15930  PRINT "SPOCK:  THIS IS COMMANDER SPOCK, SCIENCE OFFICER.  DESTRUCT"
15940  PRINT "   SEQUENCE TWO, CODE 1-1A-2B."
15950  PRINT "COMPUTER:  VOICE AND CODE VERIFIED AND CORRECT.  SEQUENCE"
15960  PRINT "   TWO COMPLETE."
15970  PRINT N$;":  MR. SCOTT?"
15980  PRINT "SCOTT:  THIS IS LIEUTENANT COMMANDER SCOTT, CHIEF ENGINEER-"
15990  PRINT "   ING OFFICER OF THE U.S.S. ";A0$(1);".  DESTRUCT SEQUENCE"
16000  PRINT "   NUMBER THREE, CODE 1-D2-B3."
16010  PRINT "COMPUTER:  VOICE AND CODE 1-D2-B3 VERIFIED AND CORRECT."
16020  PRINT "   DESTRUCT SEQUENCE COMPLETE AND ENGAGED.  AWAITING FINAL"
16030  PRINT "   CODE FOR THIRTY-SECOND COUNTDOWN."
16040  PRINT N$;":  COMPUTER, THIS IS CAPTAIN ";N$;" OF THE U.S.S. ";A0$(1);"."
16050  PRINT "  BEGIN TWENTY-SECOND COUNTDOWN, CODE 0-0-0, DESTRUCT 0."
16060  PRINT "COMPUTER:  20  SECONDS TO SELF-DESTRUCT."
16070  K(I)=10000-20/D1
16080  GOTO 16520
16090  REM  ----- (28) ABORT SELF-DESTRUCT -----
16100  PRINT "   COMPUTER, THIS IS CAPTAIN ";N$;" OF THE USS ";A0$(1);"."
16110  PRINT "   CODE 1-2-3 CONTINUITY ABORT DESTRUCT ORDER, REPEAT:"
16120  PRINT "   CODE 1-2-3 CONTINUITY ABORT DESTRUCT ORDER!"
16130  IF Z(I,1)<>0 THEN 16460
16140  IF K(I)>10000-20/D1 THEN 16180
16150  PRINT "COMPUTER:  SELF-DESTRUCT SEQUENCE CODE 1 HAS NOT BEEN"
16160  PRINT "   INITIATED."
16170  GOTO 16520
16180  PRINT "COMPUTER:  DESTRUCT ORDER ... ";
16190  IF K(I)<10000-5/D1 THEN 16230
16200  PRINT 
16210  PRINT "SPOCK:  TOO LATE, CAPTAIN..."
16220  GOTO 16520
16230  PRINT "ABORTED.  DESTRUCT ORDER ABORTED."
16240  K(I)=60
16250  GOTO 16520
16260  REM  ----- (29) BRIEFING -----
16270  PRINT 
16280  PRINT "CODE        COMMAND"
16290  PRINT 
16300   FOR K=1 TO 29
16310   PRINT K;A2$(K)
16320   IF K-INT(K/10)*10<>0 THEN 16340
16330   PRINT 
16340   NEXT K
16350  PRINT 
16360  PRINT "*DOES NOT USE A TURN"
16370  I=0
16380  GOTO 16520
16390  REM  ----- (30) CHEAT! -----
16400  GOTO 16460
16410  REM     ----- ERROR MESSAGES -----
16420  PRINT "*TIME"
16430  GOTO 16520
16440  PRINT "CHEKOV:  WHAT?"
16450  GOTO 16520
16460  PRINT "SPOCK:  OUR COMPUTER IS DOWN."
16470  GOTO 16520
16480  PRINT "SCOTT:  ENGINEERING HAS ALL READY BEEN JETTISONED."
16490  REM
16500  REM     ----- EXIT -----
16510  REM
16520  GOTO 3080
16530  REM  ---------------------TREK.4-----------------------------
16540  REM
16550  REM
16560  REM     ----- ORDER AND MOVEMENT EXECUTION -----
16570  D1=.2
16580  D2=2
16590  D3=20
16600   FOR D=1 TO 10
16610    FOR I=1 TO I1
16620    I0=I(I)
16630    IF I0=0 THEN 18370
16640    M=V=I0-INT((I0-1)*.1)*10
16650    IF I0>10 THEN 17290
16660    IF K(I) < 10000 THEN 16680
16670   IF Z(I,6)=0 THEN 17290
16680    IF Z(I,6)=0 THEN 17850
16690    GOSUB 20060
16700    M$=V$
16710    J=I
16720    REM           ----- PHASER FIRING -----
16730    IF D>K1 THEN 17070
16740     FOR K=1 TO K1
16750     IF M(I,K)>99 THEN 16780
16760     NEXT K
16770    GOTO 17070
16780    GOSUB 20390
16790    IF M(I,K)<100 THEN 17070
16800    REM  (PHASER DAMAGES)
16810    M(I,K)=M(I,K)-100
16820    PRINT ">>";M$;" FRNG PHASERS<<"
16830     FOR J=1 TO I1
16840     IF I=J THEN 17030
16850     IF I(J)=0 THEN 17030
16860     GOSUB 20770
16870     IF F=0 THEN 17030
16880     V=I(J)-INT((I(J)-1)*.1)*10
16890     GOSUB 20060
16900     ON INT((I(J)-1)/10)+1 GOTO 16910,16940,16960,16980
16910     MAT A0=A1
16920     GOSUB 20980
16930     GOTO 17030
16940     PRINT V$;"'S ENGINEERING HIT."
16950     GOTO 16990
16960     PRINT "HIT ON PROBE";J
16970     GOTO 16990
16980     PRINT "HIT ON TORPEDO";J
16990     F(J)=F(J)-F/2
17000     IF F(J)>0 THEN 17020
17010     F(J)=0
17020     K(J)=10000
17030     NEXT J
17040    Q(I,K)=Q(I,K)-F1
17050    GOTO 17290
17060    REM            ----- TORPEDO FIRING -----
17070    IF D>K2 THEN 17290
17080     FOR K=1 TO K2
17090     IF T(I,K)>99 THEN 17120
17100     NEXT K
17110    GOTO 17290
17120    GOSUB 20580
17130    IF T(I,K)<100 THEN 17290
17140    IF V(I,K)<1 THEN 17290
17150    GOSUB 20220
17160    PRINT "<<";M$;" FRNG TRPD";I3;">>"
17170    A(I3)=B(I3)=T(I,7)
17180    C(I3)=D(I3)=FNC(U(I,K)+C(I))
17190    F(I3)=V(I,K)
17200    I(I3)=I0+30
17210    K(I3)=10000-T(I,8)/D1
17220    L(I3)=T(I,9)
17230    T(I,K)=T(I,K)-100
17240    V(I,K)=0
17250    X(I3)=X(I3)+A(I3)*COS(FNA(C(I3)))*D3
17260    Y(I3)=Y(I3)+A(I3)*SIN(FNA(C(I3)))*D3
17270    REM          ----- ANTIMATTER EFFECTS -----
17280    REM  (TIME FUSE)
17290    K0=K(I)=K(I)+1
17300    IF K0>10000 THEN 17440
17310    REM  (PROXIMITY FUSE)
17320    L0=L(I)
17330    IF  L0=0 THEN 17850
17340     FOR J=1 TO I1
17350     J1=I(J)
17360     IF  J1=0 THEN 17410
17370     IF J1>20 THEN 17410
17380     IF J1=M THEN 17410
17390     IF J=I THEN 17410
17400     IF L0>SQR((X(I)-X(J))^2+(Y(I)-Y(J))^2) THEN 17440
17410     NEXT J
17420    GOTO 17850
17430    REM  (DETONATION)
17440    V=M
17450    GOSUB 20060
17460    M$=V$
17470    ON INT((I0-1)*.1)+1 GOTO 17480,17560,17580,17600
17480    PRINT "++";M$;"++"
17490     FOR K=1 TO K1
17500     F(I)=F(I)+Q(I,K)
17510     NEXT K
17520     FOR K=1 TO K2
17530     F(I)=F(I)+V(I,K)
17540     NEXT K
17550    GOTO 17610
17560    PRINT "##";M$;"'S ENGINEERING##"
17570    GOTO 17610
17580    PRINT "**  ";I;"**"
17590    GOTO 17610
17600    PRINT "::  ";I;"::"
17610     FOR J=1 TO I1
17620     IF I<>ABS(J(J)) THEN 17640
17630     J(J)=0
17640     NEXT J
17650    REM  (ANTIMATTER DAMAGES)
17660     FOR J=1 TO I1
17670     IF I(J)=0 THEN 17810
17680     IF I=J THEN 17810
17690     GOSUB 20900
17700     IF F=0 THEN 17810
17710     V=I(J)-INT((I(J)-1)*.1)*10
17720     GOSUB 20060
17730     ON INT((I(J)-1)*.1)+1 GOTO 17740,17770,17790,17800
17740     MAT A0=A2
17750     GOSUB 20980
17760     GOTO 17810
17770     PRINT "HIT ON ";V$;"'S JETTISONED ENGINEERING"
17780     GOTO 17800
17790     PRINT "HIT ON PROBE";J
17800     K(J)=9999
17810     NEXT J
17820    I(I)=0
17830    GOTO 18370
17840    REM          ----- MOVEMENT SIMULATION -----
17850    A0=A(I)
17860    B0=B(I)
17870    C0=C(I)
17880    ON INT((I0-1)*.1)+1 GOTO 17890,18320,18260,18340
17890    D0=D(I)
17900    F0=F(I)
17910    J0=J(I)
17920    Z0=Z(I,4)
17930    REM  (FUEL CONSUMPTION)
17940    IF ABS(B0)<1 THEN 18050
17950    IF Z0<>0 THEN 18000
17960    F(I)=F0=F0-ABS(B0)*E(I)*D1
17970    IF F0 >= 0 THEN 18050
17980    F(I)=0
17990    PRINT M$;"'S WARP DRIVE BURNING OUT."
18000    B(I)=ABS(B0)
18010    IF B(I)<.99 THEN 18030
18020    B(I)=.99
18030    B(I)=B0=SGN(B0)*B(I)
18040    REM  (AUTO PILOT)
18050    IF J0=0 THEN 18130
18060    J=ABS(J0)
18070    GOSUB 20090
18080    IF J0>0 THEN 18110
18090    D0=FNC(B+180)
18100    GOTO 18130
18110    D0=B
18120    REM  (TURN RATE)
18130    IF C0=D0 THEN 18320
18140    C1=FNC(D0-C0)
18150    IF C1<180 THEN 18170
18160    C1=C1-360
18170    C2=(10-ABS(B0))*5*D1
18180    IF  Z0 <> 0 THEN 18200
18190    C2=C2*.5
18200    C(I)=ABS(C1)
18210    IF C2>C(I) THEN 18230
18220    C(I)=C2
18230    C(I)=C0=FNC(C0+SGN(C1)*C(I))
18240    GOTO 18320
18250    REM  (PROBES)
18260    IF  J(I) <> 0 THEN 18340
18270    J=J(I)
18280    GOSUB 20090
18290    C0=B
18300    GOTO 18340
18310    REM  (ACCELERATION)
18320    A1=B0-A0
18330    A(I)=A0=A0+SGN(A1)*SQR(ABS(A1))*D1
18340    C3=FNA(C0)
18350    X(I)=X(I)+A0*COS(C3)*D3
18360    Y(I)=Y(I)+A0*SIN(C3)*D3
18370    NEXT I
18380   NEXT D
18390  REM     ----- DISTRIBUTION AND WEAPON LOCKS -----
18400  D4=D2
18410   FOR I=1 TO N
18420   IF I(I)=0 THEN 18540
18430   IF I(I)>10 THEN 18540
18440   J=I
18450   GOSUB 21550
18460    FOR K=1 TO K1
18470    IF M(I,K)<0 THEN 18490
18480    GOSUB 20390
18490    NEXT K
18500    FOR K=1 TO K2
18510    IF T(I,K)<0 THEN 18530
18520    GOSUB 20580
18530    NEXT K
18540   NEXT I
18550  REM        ----- SELF-DESTRUCT WARNING -----
18560  IF I(1)<>1 THEN 18620
18570  K0=(10000-K(1))*D1
18580  IF K0>15 THEN 18620
18590  IF K0=0 THEN 18620
18600  PRINT "COMPUTER:  ";K0;"SECONDS TO SELF-DESTRUCT."
18610  REM  (RUSES, BLUFFS, SURRENDERS)
18620  IF  P1=0 THEN 18640
18630  P1=P1+1
18640  IF  P2=0 THEN 18660
18650  P2=P2+1
18660  IF  P3=0 THEN 18680
18670  P3=P3+1
18680  IF  P4=0 THEN 18710
18690  P4=P4+1
18700  REM          ----- END GAME DECISION -----
18710  I=N1=N2=0
18720  REM  (FEDERATION DISPOSITION)
18730  IF I(1) <> 1 THEN 18850
18740  IF Z(1,6)=0 THEN 18850
18750  IF F(1)<=10 THEN 18780
18760  IF Z(1,3)=0 THEN 18870
18770  IF Z(1,4)=0 THEN 18870
18780  IF G(1)>1 THEN 18870
18790   FOR K=1 TO K1
18800   IF Q(1,K)<>0 THEN 18870
18810   NEXT K
18820   FOR K=1 TO K2
18830   IF V(1,K)<>0 THEN 18870
18840   NEXT K
18850  O1=1
18860  REM  (ENEMY DISPOSITION)
18870  K0=K(1)
18880   FOR J=2 TO N
18890   IF I(J)=0 THEN 19050
18900   IF I(J)>10 THEN 19050
18910   IF Z(J,6)=0 THEN 19050
18920   IF O1<>0 THEN 19080
18930   R=SQR((X(1)-X(J))^2+(Y(1)-Y(J))^2)
18940   IF R<=3000 THEN 18960
18950   IF Z(J,4)<>0 THEN 19070
18960   IF R<=4000 THEN 18980
18970   IF K0>100 THEN 19070
18980   IF F(J)>10 THEN 19080
18990    FOR K=1 TO K1
19000    IF Q(J,K)<>0 THEN 19080
19010    NEXT K
19020    FOR K=1 TO K2
19030    IF V(J,K)<>0 THEN 19080
19040    NEXT K
19050   N1=N1+1
19060   GOTO 19080
19070   N2=N2+1
19080   NEXT J
19090  IF O1<>0 THEN 19110
19100  IF N1+N2<A THEN 19830
19110  IF O1<>1 THEN 19130
19120  IF N1+N2<A THEN 19240
19130  IF O1<>0 THEN 19150
19140  IF N1=A THEN 19200
19150  IF O1<>0 THEN 19170
19160  IF N1+N2=A THEN 19220
19170  IF O1<>1 THEN 19190
19180  IF N1=A THEN 19780
19190  GOTO 19240
19200  O1=2
19210  GOTO 19240
19220  O1=3
19230  REM  (ANYTHING OTHER THAN VESSELS REMAINING)
19240   FOR J=1 TO I1
19250   IF I(J)>10 THEN 19330
19260   NEXT J
19270  PRINT 
19280  PRINT "STARFLEET COMMAND:  ";
19290  IF O1<1 THEN 19320
19300  IF O1>5 THEN 19320
19310  ON O1 GOTO 19430,19530,19610,19680,19750
19320 REM (WARNING)
19330  IF O1=O2 THEN 19830
19340  O2=O1
19350  PRINT 
19360  IF O1<1 THEN 19390
19370  IF O1>5 THEN 19390
19380  ON O1 GOTO 19390,19490,19580,19660,19720
19390  PRINT S$;";  MESSAGE TO THE FEDERATION:  THIS IS COMMANDER ";S$;" OF"
19400  PRINT "   THE ";R$;" EMPIRE.  WE HAVE DEFEATED THE ";A0$(1);" AND ARE"
19410  PRINT "   DEPARTING THE QUADRANT."
19420  GOTO 19830
19430  PRINT "WE HAVE RECEIVED CONFIRMATION THAT THE"
19440  PRINT "   USS ";A0$(1);", CAPTAINED BY ";N$;", WAS DESTROYED"
19450  PRINT "   BY ";R$;" BATTLE CRUISERS.  MAY FUTURE FEDERATION"
19460  PRINT "   OFFICERS PERFORM BETTER IN THEIR DUTIES, AND"
19470  PRINT "   REGARDS TO CAPTAIN DUNSIL!"
19480  GOTO 19840
19490  PRINT "SPOCK:  ALL ";R$;" VESSELS HAVE BEEN EITHER DESTROYED OR"
19500  PRINT "   CRIPPLED.  WE STILL, HOWEVER, HAVE ANTIMATTER DEVICES TO"
19510  PRINT "   AVOID."
19520  GOTO 19830
19530  PRINT "WE COMMEND CAPTAIN ";N$;" AND THE CREW OF THE"
19540  PRINT "   U.S.S. ";A0$(1);" ON THEIR FINE PERFORMANCE "
19550  PRINT "   AGAINST THE ";R$;"S.  MAY THEY BE AN INSPIRATION"
19560  PRINT "   TO FUTURE STARSHIP CAPTAINS AND CREWS."
19570  GOTO 19840
19580  PRINT "SULU:  THE ";R$;"S ARE FALLING BEHIND AND SEEM TO BE"
19590  PRINT "   BREAKING OFF THEIR ATTACK."
19600  GOTO 19830
19610  PRINT "CAPTAIN ";N$;" OF THE STARSHIP ";A0$(1);" HAS"
19620  PRINT " OUTMANUEVERED ";R$;"AGGRESSORS.  WE CONGRATULATE "
19630 PRINT " THE CREW OF THE ";A0$(1);" AND COMMEND CAPTAIN ";N$;"'S"
19640 PRINT " TACTICAL ABILITY." 
19650 GOTO 19840
19660 PRINT "UHURA: I'M INFORMING STARFLEET COMMAND OF OUR DISPOSITION."
19670 GOTO 19830
19680 PRINT "CAPTAIN ";N$;" OF THE STARSHIP ";A0$(1);" HAS"
19690 PRINT "SURRENDERED HIS VESSLE TO THE ";R$;"S. "
19700 PRINT " REGARDS TO CAPTAIN DUNSIL!"
19710 GOTO 19840
19720 PRINT "SPOCK: ALTHOUGH THE ";R$;"'S HAVE SURRENDERED, THERE"
19730 PRINT " REMAIN ANTIMATTER DEVICES AROUND."
19740 GOTO 19830
19750 PRINT "WE HAVE RECEIVED WORD FROM THE ";A0$(1);" THAT"
19760 PRINT " THE ";R$;"S HAVE SURRENDERED."
19770 GOTO 19840
19780 PRINT
19790 PRINT "STARFLEET COMMAND: ";
19800 PRINT "ONE OF OUR VESSELS HAS REPORTED THE WRECKAGE"
19810 PRINT " OF THE ";A0$(1);" AND ";A;"OTHER ";R$;" VESSEL(S)."
19820 GOTO 19840
19830 GOTO 3080
19840 PRINT
19850 L=0
19860 FOR I=1 TO N
19870 V=I(I)
19880 IF V=0 THEN 19950
19890 IF V>10 THEN 19950
19900 IF L<>0 THEN 19930
19910 PRINT "SURVIVORS REPORTED:"
19920 L=1
19930 GOSUB 20060
19940 PRINT " ";V$;"--";Z(I,6)
19950 NEXT I
19960 IF L<>0 THEN 19980
19970 PRINT "*** NO SURVIVORS REPORTED ***"
19980 PRINT
19990 PRINT
20000 PRINT "COMPUTER: DO YOU DESIRE ANOTHER BATTLE?"
20010 PRINT "FUTURE CAPTAIN: [YES OR NO] ";
20020 INPUT X$
20030 IF LEFT$(X$,1)="N" THEN 22510
20040 RESTORE
20050 GOTO 150
20060 REM ===== NAME SUBROUTINE =====
20070 V$=A0$(V)
20080 RETURN
20090 REM ----- BEARING SUBROUTINE -----
20100 X=X(J)-X(I)
20110 Y=Y(J)-Y(I)
20120 IF X=0 THEN 20150
20130 B=ATN(Y/X)*57.2958
20140 GOTO 20160
20150 B=90
20160 IF X<0 THEN 20180
20170 IF Y >= 0 THEN 20210
20180 B=B+180
20190 IF X<0 THEN 20210
20200 B=B+180
20210 RETURN
20220 REM ----- SLOT I SUBROUTINE -----
20230 FOR I3=1 TO I2
20240 IF I(I3)=0 THEN 20300
20250 NEXT I3
20260 PRINT
20270 PRINT "GAME WILL TERMINATE BECAUSE OF INABILITY TO COPE WITH"
20280 PRINT "ALL THE DEBRIS (VESSELS, PROBES, TORPEDOES, ETC.) IN SPACE."
20290 STOP
20300 I(I3)=1000
20310 A(I3)=B(I3)=C(I3)=D(I3)=E(I3)=F(I3)=J(I3)=K(I3)=L(I3)=0
20320 X(I3)=X(I)
20330 Y(I3)=Y(I)
20340 FOR I1=I2 TO 1 STEP -1
20350 IF I(I1)>0 THEN 20370
20360 NEXT I1
20370 I(I3)=0
20380 RETURN
20390 REM ----- PHASER TRACKING SUBROUTINE -----
20400 J=M(I,K)
20410 IF J<100 THEN 20430
20420 J=J-100
20430 IF J=0 THEN 20470
20440 IF I(J)=0 THEN 20520
20450 GOSUB 20090
20460 N(I,K)=FNC(B-C(I))
20470 IF N(I,K)<125 THEN 20510
20480 IF N(I,K)>235 THEN 20510
20490 IF Z(I,5)<>0 THEN 20510
20500 M(I,K)=J
20510 RETURN
20520 V=I(I)
20530 IF V>1 THEN 20560
20540 GOSUB 20060
20550 PRINT "   PHASER  ";K;"DISENGAGING."
20560  M(I,K)=0
20570  RETURN 
20580  REM          ----- TORPEDO TRACKING SUBROUTINE -----
20590  J=T(I,K)
20600  IF J<100 THEN 20620
20610  J=J-100
20620  IF J=0 THEN 20680
20630  IF I(J)=0 THEN 20710
20640  GOSUB 20090
20650  U(I,K)=FNC(B-C(I))
20660  IF U(I,K)>225 THEN 20700
20670  IF Z(I,5)<>0 THEN 20700
20680  IF U(I,K)<135 THEN 20700
20690  T(I,K)=J
20700  RETURN 
20710  V=I(I)
20720  IF V>1 THEN 20750
20730  GOSUB 20060
20740  PRINT "   TUBE  ";K;"DISENGAGING."
20750  T(I,K)=0
20760  RETURN 
20770  REM          ----- PHASER HIT FACTOR SUBROUTINE -----
20780  F=0
20790  F1=M(I,6)*Q(I,K)*.01
20800  GOSUB 20090
20810  F2=1000
20820  G2=SQR((X(I)-X(J))^2+(Y(I)-Y(J))^2)
20830  IF G2>F2 THEN 20890
20840  F3=M(I,5)
20850  G3=FNC(C(I)+N(I,K)-B)
20860  IF G3<=F3 THEN 20880
20870  IF 360-G3>F3 THEN 20890
20880  F=INT(F1*SQR(1-G2/F2)*45/F3)
20890  RETURN 
20900  REM          ----- ANTIMATTER HIT FACTOR SUBROUTINE -----
20910  F=0
20920  F1=F(I)*5
20930  G2=SQR((X(I)-X(J))^2+(Y(I)-Y(J))^2)
20940  F2=F1*10
20950  IF G2>F2 THEN 20970
20960  F=INT(F1*SQR(1-G2/F2))
20970  RETURN 
20980  REM     ===== DAMAGE ASSESSMENT SUBROUTINE =====
20990  GOSUB 20090
21000  B1=FNC(B-C(J)+180)
21010  S=1
21020  IF B1<45 THEN 21090
21030  IF B1>315 THEN 21090
21040  S=2
21050  IF B1<135 THEN 21090
21060  S=3
21070  IF B1<225 THEN 21090
21080  S=4
21090  PRINT "HIT  ";F;"ON ";V$;"'S SHIELD";S
21100  IF F<300 THEN 21120
21110  K(J)=10000
21120  REM
21130  H=F*(1-S(J,S)*S(J,S+4)/100)
21140  E(J)=E(J)+H/A0(1)
21150  F(J)=F(J)-H/A0(2)
21160  IF F(J)>0 THEN 21180
21170  F(J)=0
21180  G(J)=G(J)-H/A0(3)
21190  IF G(J)>0 THEN 21210
21200  G(J)=0
21210  IF S>1 THEN 21230
21220  A0(4)=A0(4)*1.5
21230  S(J,S+4)=S(J,S+4)-F/A0(4)
21240  IF S(J,S+4)>0 THEN 21260
21250  S(J,S+4)=0
21260  Z(J,6)=Z(J,6)-FNR(H*A0(5))
21270  IF Z(J,6)>0 THEN 21290
21280  Z(J,6)=0
21290   FOR H1=1 TO H/A0(6)
21300   L=FNR(K1+K2)
21310   IF L>K1 THEN 21380
21320   IF M(J,L)<0 THEN 21440
21330   M(J,L)=-1
21340   Q(J,L)=R(J,L)=0
21350   IF J>1 THEN 21440
21360   PRINT "   PHASER  ";L;"DAMAGED."
21370   GOTO 21440
21380   L=L-K1
21390   IF T(J,L)<0 THEN 21440
21400   T(J,L)=-1
21410   V(J,L)=0
21420   IF J>1 THEN 21440
21430   PRINT "   TUBE  ";L;"DAMAGED."
21440   NEXT H1
21450   FOR L=1 TO 4
21460   IF H<FNR(A0(L+6)) THEN 21510
21470   IF Z(J,L)<>0 THEN 21510
21480   Z(J,L)=1
21490   IF J>1 THEN 21510
21500   PRINT "   ";A3$(L)
21510   NEXT L
21520  IF H<42 THEN 21540
21530  K(J)=10000
21540  D4=D1
21550  REM     ===== DISTRIBUTION SUBROUTINE =====
21560  H=F(J)+G(J)*D4
21570   FOR L=1 TO K1
21580   IF M(J,L)<0 THEN 21650
21590   IF R(J,L) >= 0 THEN 21650
21600   Q=-R(J,L)*D4
21610   IF Q(J,L)>Q THEN 21630
21620   Q=Q(J,L)
21630   Q(J,L)=Q(J,L)-Q
21640   H=H+Q
21650   NEXT L
21660   FOR L=1 TO 4
21670   IF  S(J,L+4)=0 THEN 21730
21680   H1=S(J,L)*D4
21690   IF H>H1 THEN 21710
21700   H1=H
21710   H=H-H1
21720   S(J,L)=H1/D4
21730   NEXT L
21740  IF H=0 THEN 21870
21750   FOR L=1 TO K1
21760   IF Q(J,L) >= 10 THEN 21860
21770   IF M(J,L)<0 THEN 21860
21780   IF R(J,L)<0 THEN 21860
21790   H1=10-Q(J,L)
21800   IF H>H1 THEN 21820
21810   H1=H
21820   IF R(J,L)*D4>H1 THEN 21840
21830   H1=R(J,L)*D4
21840   H=H-H1
21850   Q(J,L)=Q(J,L)+H1
21860   NEXT L
21870  F(J)=H(J)
21880  IF H>F(J) THEN 21900
21890  F(J)=H
21900  H=H-F(J)
21910  IF H <= 0 THEN 22010
21920   FOR L=1 TO K1
21930   IF M(J,L)<0 THEN 22000
21940   H1=10-Q(J,L)
21950   IF H>H1 THEN 21970
21960   H1=H
21970   Q(J,L)=Q(J,L)+H1
21980   H=H-H1
21990   IF H <= 0 THEN 22010
22000   NEXT L
22010  RETURN 
22020  REM 
22030  REM   ----- RESTORE DATA -----
22040  READ X$
22050  IF X$<>"" THEN 22040
22060  RETURN
22070  REM   ----- CREATE DATA MATRIXES -----
22080  READ X$
22090  IF X$<>"." THEN 22080
22100   FOR I=2 TO 10
22110   READ A0$(I)
22120   NEXT I
22130   FOR I=1 TO 5
22140   READ A1$(I)
22150   NEXT I
22160   FOR I=1 TO 29
22170   READ A2$(I)
22180   NEXT I
22190   FOR I=1 TO 4
22200   READ A3$(I)
22210   NEXT I
22220  MAT READ A1,A2
22230  RETURN
22240  DATA "."
22250  DATA "Bismark","Centaur","Draddock","Forbin"
22260  DATA "Kreiger","Shlurg","Trakka","Varnor","Warrior"
22270  DATA "Computer inoperable","Sensors annahilated"
22280  DATA "Probe launcher shot","Warp drive disabled"
22290  DATA "Engineering jettisoned"
22300  DATA "Fire phasers","Fire photon torpedoes"
22310  DATA "*LOCK PHASERS ONTO TARGET","*LOCK TUBES ONTO TARGET"
22320  DATA "*MANUALLY ROTATE PHASERS","*MANUALLY ROTATE TUBES"
22330 DATA "*PHASER STATUS","*TUBE STATUS","*LOAD/UNLOAD TUBES"
22340  DATA "Launch antimatter probe"
22350  DATA "Probe control (Detonate, Direct, Lock)"
22360  DATA "*Position report","*Position display"
22370  DATA "Pursue an enemy vessel","Run from an enemy vessel"
22380  DATA "Manually change course and speed"
22390  DATA "*DAMAGE REPORT","*SCAN ENEMY (DAMAGE OF ENEMY)"
22400  DATA "*ALTER POWER DISTRIBUTION"
22410  DATA "Alter torpedo and phaser firing parameters"
22420  DATA "Jettision engineering","Detonate engineering"
22430  DATA "Attempt defenseless ruse","Attempt corbomite bluff(s)"
22440  DATA "Surrender","Ask enemy to surrender"
22450  DATA "Initiate self-destruct sequence","Abort self-destruct"
22460  DATA "*Reprints above list"
22470  DATA "Computer destroyed.","Sensors demolished" 
22480  DATA "Probe launcher crushed","Warp drive destroyed"
22490  DATA 50,2,20,3,10,3,1000,500,100,50
22500  DATA 100,3,10,2,7,6,1500,750,150,75
22501 PRINT"WATCH YOUR FUEL AT THIS SPEED AS YOU WILL SOON HAVE"
22502 PRINT"NONE !!!!!!!!!"
22503 GOTO 12750
22510  END
